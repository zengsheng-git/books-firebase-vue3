import{L as Q}from"./LogoutButton-a9945e42.js";import{i as U,r as m,j as R,o as p,c as _,b as e,d as v,w as x,g as w,e as y,k as H,l as O,v as G,m as K,F as B,n as L,p as W,t as g,q as j,a as z}from"./index-09629cb6.js";import{u as Y,_ as D,d as C,I as A,R as T,b as k,x as M,a as $,y as J,g as X,k as Z,p as ee}from"./auth-58a4edec.js";import{F as V,E as F,N as te,a as se,T as N}from"./ToastHelper-f08ce36c.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";const q=U("dashboard",()=>{const i=[],c=[],r=Y(),l=s=>{c.push(s)},d=(s,a="")=>{console.error(s),i.push(a)};return{error:i,list:c,getAll:async()=>{i.splice(0,i.length),c.splice(0,c.length);try{await r.fetchUser();let s=r.user.data;if(!s)return;let a=D(C,A),u=T(a,k("userId","==",s.id),M("createdAt","desc")),o=await $(u);if(o.docs.length==0)return;o.forEach(t=>{var n=t.data();n.collection=t.id,l(n)})}catch(s){d(s,"Error to load data")}},deleteItem:async s=>{i.splice(0,i.length);try{let a=r.user.data,u=D(C,A),o=T(u,k("ID","==",s),k("userId","==",a.id)),t=await $(o);await J(t.docs[0].ref)}catch(a){d(a,"Error to delete")}},updateItem:async s=>{i.splice(0,i.length);try{let a=r.user.data,u=D(C,A),o=T(u,k("ID","==",s.ID),k("userId","==",a.id)),t=await $(o),n={description:s.description||"",title:s.title||""};await X(t.docs[0].ref,n)}catch(a){d(a,"Error to update")}},addNewItem:async s=>{i.splice(0,i.length);try{let a=r.user.data,u=D(C,A),o=T(u,k("userId","==",a.id),M("ID","desc"),Z(1)),t=await $(o),n=0;t.empty||(n=t.docs[0].data().ID);let P={ID:n+1,createdAt:Date(),title:s.title,description:s.description||"-",userId:a.id};await ee(u,P)}catch(a){d(a,"Error to create")}}}}),ae=i=>{const c=new Date(i);return c.toLocaleDateString()+" "+c.toLocaleTimeString()};const oe={class:"modal fade",id:"newModal",tabindex:"-1","aria-labelledby":"newModal","aria-hidden":"true"},le={class:"modal-dialog"},ne={class:"modal-header"},re={class:"modal-body text-start"},de={class:"mb-3"},ie={class:"fv-plugins-message-container"},ce={class:"fv-help-block text-danger"},ue={class:"mb-3"},pe={class:"fv-plugins-message-container"},_e={class:"fv-help-block text-danger"},me={class:"modal-footer"},ve=["disabled"],be={key:0,type:"button",class:"btn btn-loading",disabled:""},fe={key:1,type:"submit",class:"btn btn-primary"},he={__name:"createModal",emits:["itemAdded"],setup(i,{emit:c}){const r=q(),l=c,d=m(""),f=m(!1),h=m(null),b=m(null),I=m(null);m(null);async function s(o){if(f.value=!0,await r.addNewItem(o),f.value=!1,r.error.length>0){N.error(r.error[0]);return}N.success("Added with sucessful"),u()}function a(){d.value="",b.value&&(b.value.value="")}async function u(){a(),h.value&&h.value.click(),l("itemAdded"),I.value&&I.value.resetForm()}return R(d,o=>{o==="<p><br></p>"&&(d.value="")}),(o,t)=>(p(),_("div",oe,[e("div",le,[v(y(se),{class:"modal-content",ref_key:"kt_modal_create_form",ref:I,onSubmit:s,"validation-schema":y(te)},{default:x(()=>[e("div",ne,[t[1]||(t[1]=e("h5",{class:"modal-title"},[w("New Book "),e("i",{class:"bi bi-clipboard-check-fill"})],-1)),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref_key:"closeModalRef",ref:h},null,512)]),e("div",re,[e("div",de,[t[2]||(t[2]=e("label",{for:"title",class:"form-label"},[w("Title "),e("span",{class:"text-danger"},"*")],-1)),v(y(V),{class:"form-control form-control-solid",type:"text",name:"title",placeholder:"Book title",ref_key:"titleInput",ref:b},null,512),e("div",ie,[e("div",ce,[v(y(F),{name:"title"})])])]),e("div",ue,[t[3]||(t[3]=e("label",{for:"description",class:"form-label"},[w("Description "),e("span",{class:"text-danger"},"*")],-1)),v(y(V),{class:"form-control form-control-solid",type:"text",name:"description",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=n=>d.value=n)},null,8,["modelValue"]),e("div",pe,[e("div",_e,[v(y(F),{name:"description"})])])])]),e("div",me,[e("button",{type:"button",class:"btn btn-secondary",onClick:u,disabled:f.value},"Close",8,ve),f.value?(p(),_("button",be,[...t[4]||(t[4]=[e("div",{class:"spinner-border",style:{width:"1rem",height:"1rem","border-width":"2px"},role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):(p(),_("button",fe,"Save changes"))])]),_:1},8,["validation-schema"])])]))}},ye=S(he,[["__scopeId","data-v-a5c902ce"]]);const ge={class:"dashboard-table-container"},we={class:"navbar"},Ie={key:0,type:"button",class:"btn btn-secondary",style:{padding:"5px 15px !important"},disabled:""},ke={class:"table m-0"},xe=["textContent"],De={key:0},Ce={key:1},Ae={colspan:"5",rowspan:"5"},Te={class:"fw-bold"},$e={__name:"Table",setup(i){const c=q(),r=m([]),l=m([]),d=[{text:"#",class:"fw-bold"},{text:"Title",class:""},{text:"Description ",class:""},{text:"Created At",class:""}],f=m("");m({});const h=m(!1),b=m("");function I(o){if(o.target.scrollTop>0){f.value="sticky-scroll";return}f.value=""}async function s(){h.value=!0,await c.getAll();let{error:o,list:t}=c;if(h.value=!1,o.length>0){N.error(o[0]);return}r.value=t,l.value=t}function a(){if(b.value==""){r.value=l.value;return}let o=b.value.toLowerCase();r.value=l.value.filter(({title:t})=>t.toLowerCase().includes(o))}H(async()=>{await s(),l.value=r.value}),R(b,()=>{a()});async function u(){await s()}return(o,t)=>(p(),_("div",ge,[v(ye,{onItemAdded:u}),e("nav",we,[O(e("input",{type:"text",class:"form-control input-search",placeholder:"Search","onUpdate:modelValue":t[0]||(t[0]=n=>b.value=n),onKeypress:K(a,["enter"])},null,544),[[G,b.value]]),h.value?(p(),_("button",Ie,[...t[1]||(t[1]=[e("div",{class:"spinner-border",style:{width:"1rem",height:"1rem","border-width":"2px"},role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):(p(),_("i",{key:1,class:"bi bi-search btn btn-outline-primary shadow-none",onClick:a})),t[2]||(t[2]=e("i",{class:"bi bi-plus-lg btn btn-outline-success shadow-none","data-bs-toggle":"modal","data-bs-target":"#newModal"},null,-1))]),e("div",{class:"table-list",onScroll:I},[e("table",ke,[e("thead",null,[e("tr",null,[(p(),_(B,null,L(d,n=>e("th",{scope:"col",class:W(f.value+" "+n.class),textContent:g(n.text)},null,10,xe)),64))])]),e("tbody",null,[h.value?(p(),_("tr",De,[...t[3]||(t[3]=[e("td",{colspan:"5",rowspan:"5"},[e("div",{class:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},[e("span",{class:"visually-hidden"},"Loading...")])],-1)])])):r.value.length===0?(p(),_("tr",Ce,[e("td",Ae,g(l.value.length>0?"No results found ðŸ”":"You don't have Books yet... â›³"),1)])):j("",!0),(p(!0),_(B,null,L(r.value,(n,E)=>(p(),_("tr",{key:E},[e("td",Te,g(E+1),1),e("td",null,g(n.title),1),e("td",null,g(n.description),1),e("td",null,g(y(ae)(n.createdAt)),1)]))),128))])])],32)]))}},Ee=S($e,[["__scopeId","data-v-81c9c904"]]);const Ne={class:"dashboard-container"},Se={class:"dashboard-header"},Be={class:"header-left"},Le={class:"navigation"},Me={class:"userWrip"},Ve={class:"username-display"},Fe={__name:"Dashboard",setup(i){const c=localStorage.getItem("userName");return(r,l)=>{const d=z("router-link");return p(),_("div",Ne,[e("div",Se,[e("div",Be,[l[4]||(l[4]=e("h1",{class:"main-title"},"Books List",-1)),e("nav",Le,[v(d,{to:"/",class:"nav-link"},{default:x(()=>[...l[0]||(l[0]=[w("Book management",-1)])]),_:1}),v(d,{to:"/weather",class:"nav-link"},{default:x(()=>[...l[1]||(l[1]=[w("Weather inquiry",-1)])]),_:1}),v(d,{to:"/CountBookAPI",class:"nav-link"},{default:x(()=>[...l[2]||(l[2]=[w("Count Book API",-1)])]),_:1}),v(d,{to:"/GetBookCount",class:"nav-link"},{default:x(()=>[...l[3]||(l[3]=[w("Get Book Count",-1)])]),_:1})])]),e("div",Me,[e("div",Ve,g(y(c)),1),v(Q)])]),v(Ee)])}}},He=S(Fe,[["__scopeId","data-v-4cf0ab79"]]);export{He as default};
