import{bU as Gh,bV as G,bT as Wh,i as Qh,bW as va,bX as ya,bY as Xh,h as Yh}from"./index-6d6da8c9.js";const ws="users",Cg="items";var ac={exports:{}};function Zh(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var As={exports:{}};const Jh={},el=Object.freeze(Object.defineProperty({__proto__:null,default:Jh},Symbol.toStringTag,{value:"Module"})),tl=Gh(el);var Ea;function X(){return Ea||(Ea=1,function(n,e){(function(t,r){n.exports=r()})(G,function(){var t=t||function(r,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof G<"u"&&G.crypto&&(i=G.crypto),!i&&typeof Zh=="function")try{i=tl}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function p(){}return function(m){var y;return p.prototype=m,y=new p,p.prototype=null,y}}(),u={},c=u.lib={},h=c.Base=function(){return{extend:function(p){var m=a(this);return p&&m.mixIn(p),(!m.hasOwnProperty("init")||this.init===m.init)&&(m.init=function(){m.$super.init.apply(this,arguments)}),m.init.prototype=m,m.$super=this,m},create:function(){var p=this.extend();return p.init.apply(p,arguments),p},init:function(){},mixIn:function(p){for(var m in p)p.hasOwnProperty(m)&&(this[m]=p[m]);p.hasOwnProperty("toString")&&(this.toString=p.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=c.WordArray=h.extend({init:function(p,m){p=this.words=p||[],m!=s?this.sigBytes=m:this.sigBytes=p.length*4},toString:function(p){return(p||f).stringify(this)},concat:function(p){var m=this.words,y=p.words,A=this.sigBytes,w=p.sigBytes;if(this.clamp(),A%4)for(var D=0;D<w;D++){var _=y[D>>>2]>>>24-D%4*8&255;m[A+D>>>2]|=_<<24-(A+D)%4*8}else for(var L=0;L<w;L+=4)m[A+L>>>2]=y[L>>>2];return this.sigBytes+=w,this},clamp:function(){var p=this.words,m=this.sigBytes;p[m>>>2]&=4294967295<<32-m%4*8,p.length=r.ceil(m/4)},clone:function(){var p=h.clone.call(this);return p.words=this.words.slice(0),p},random:function(p){for(var m=[],y=0;y<p;y+=4)m.push(o());return new d.init(m,p)}}),l=u.enc={},f=l.Hex={stringify:function(p){for(var m=p.words,y=p.sigBytes,A=[],w=0;w<y;w++){var D=m[w>>>2]>>>24-w%4*8&255;A.push((D>>>4).toString(16)),A.push((D&15).toString(16))}return A.join("")},parse:function(p){for(var m=p.length,y=[],A=0;A<m;A+=2)y[A>>>3]|=parseInt(p.substr(A,2),16)<<24-A%8*4;return new d.init(y,m/2)}},x=l.Latin1={stringify:function(p){for(var m=p.words,y=p.sigBytes,A=[],w=0;w<y;w++){var D=m[w>>>2]>>>24-w%4*8&255;A.push(String.fromCharCode(D))}return A.join("")},parse:function(p){for(var m=p.length,y=[],A=0;A<m;A++)y[A>>>2]|=(p.charCodeAt(A)&255)<<24-A%4*8;return new d.init(y,m)}},v=l.Utf8={stringify:function(p){try{return decodeURIComponent(escape(x.stringify(p)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(p){return x.parse(unescape(encodeURIComponent(p)))}},g=c.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(p){typeof p=="string"&&(p=v.parse(p)),this._data.concat(p),this._nDataBytes+=p.sigBytes},_process:function(p){var m,y=this._data,A=y.words,w=y.sigBytes,D=this.blockSize,_=D*4,L=w/_;p?L=r.ceil(L):L=r.max((L|0)-this._minBufferSize,0);var C=L*D,B=r.min(C*4,w);if(C){for(var S=0;S<C;S+=D)this._doProcessBlock(A,S);m=A.splice(0,C),y.sigBytes-=B}return new d.init(m,B)},clone:function(){var p=h.clone.call(this);return p._data=this._data.clone(),p},_minBufferSize:0});c.Hasher=g.extend({cfg:h.extend(),init:function(p){this.cfg=this.cfg.extend(p),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(p){return this._append(p),this._process(),this},finalize:function(p){p&&this._append(p);var m=this._doFinalize();return m},blockSize:16,_createHelper:function(p){return function(m,y){return new p.init(y).finalize(m)}},_createHmacHelper:function(p){return function(m,y){return new E.HMAC.init(p,y).finalize(m)}}});var E=u.algo={};return u}(Math);return t})}(As)),As.exports}var Ds={exports:{}},Ca;function qr(){return Ca||(Ca=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(r){var s=t,i=s.lib,o=i.Base,a=i.WordArray,u=s.x64={};u.Word=o.extend({init:function(c,h){this.high=c,this.low=h}}),u.WordArray=o.extend({init:function(c,h){c=this.words=c||[],h!=r?this.sigBytes=h:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,h=c.length,d=[],l=0;l<h;l++){var f=c[l];d.push(f.high),d.push(f.low)}return a.create(d,this.sigBytes)},clone:function(){for(var c=o.clone.call(this),h=c.words=this.words.slice(0),d=h.length,l=0;l<d;l++)h[l]=h[l].clone();return c}})}(),t})}(Ds)),Ds.exports}var Bs={exports:{}},wa;function nl(){return wa||(wa=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,s=r.lib,i=s.WordArray,o=i.init,a=i.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var c=u.byteLength,h=[],d=0;d<c;d++)h[d>>>2]|=u[d]<<24-d%4*8;o.call(this,h,c)}else o.apply(this,arguments)};a.prototype=i}}(),t.lib.WordArray})}(Bs)),Bs.exports}var _s={exports:{}},Aa;function rl(){return Aa||(Aa=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(u){for(var c=u.words,h=u.sigBytes,d=[],l=0;l<h;l+=2){var f=c[l>>>2]>>>16-l%4*8&65535;d.push(String.fromCharCode(f))}return d.join("")},parse:function(u){for(var c=u.length,h=[],d=0;d<c;d++)h[d>>>1]|=u.charCodeAt(d)<<16-d%2*16;return i.create(h,c*2)}},o.Utf16LE={stringify:function(u){for(var c=u.words,h=u.sigBytes,d=[],l=0;l<h;l+=2){var f=a(c[l>>>2]>>>16-l%4*8&65535);d.push(String.fromCharCode(f))}return d.join("")},parse:function(u){for(var c=u.length,h=[],d=0;d<c;d++)h[d>>>1]|=a(u.charCodeAt(d)<<16-d%2*16);return i.create(h,c*2)}};function a(u){return u<<8&4278255360|u>>>8&16711935}}(),t.enc.Utf16})}(_s)),_s.exports}var Fs={exports:{}},Da;function bt(){return Da||(Da=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.enc;o.Base64={stringify:function(u){var c=u.words,h=u.sigBytes,d=this._map;u.clamp();for(var l=[],f=0;f<h;f+=3)for(var x=c[f>>>2]>>>24-f%4*8&255,v=c[f+1>>>2]>>>24-(f+1)%4*8&255,g=c[f+2>>>2]>>>24-(f+2)%4*8&255,E=x<<16|v<<8|g,p=0;p<4&&f+p*.75<h;p++)l.push(d.charAt(E>>>6*(3-p)&63));var m=d.charAt(64);if(m)for(;l.length%4;)l.push(m);return l.join("")},parse:function(u){var c=u.length,h=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var l=0;l<h.length;l++)d[h.charCodeAt(l)]=l}var f=h.charAt(64);if(f){var x=u.indexOf(f);x!==-1&&(c=x)}return a(u,c,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(u,c,h){for(var d=[],l=0,f=0;f<c;f++)if(f%4){var x=h[u.charCodeAt(f-1)]<<f%4*2,v=h[u.charCodeAt(f)]>>>6-f%4*2,g=x|v;d[l>>>2]|=g<<24-l%4*8,l++}return i.create(d,l)}}(),t.enc.Base64})}(Fs)),Fs.exports}var bs={exports:{}},Ba;function sl(){return Ba||(Ba=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.enc;o.Base64url={stringify:function(u,c){c===void 0&&(c=!0);var h=u.words,d=u.sigBytes,l=c?this._safe_map:this._map;u.clamp();for(var f=[],x=0;x<d;x+=3)for(var v=h[x>>>2]>>>24-x%4*8&255,g=h[x+1>>>2]>>>24-(x+1)%4*8&255,E=h[x+2>>>2]>>>24-(x+2)%4*8&255,p=v<<16|g<<8|E,m=0;m<4&&x+m*.75<d;m++)f.push(l.charAt(p>>>6*(3-m)&63));var y=l.charAt(64);if(y)for(;f.length%4;)f.push(y);return f.join("")},parse:function(u,c){c===void 0&&(c=!0);var h=u.length,d=c?this._safe_map:this._map,l=this._reverseMap;if(!l){l=this._reverseMap=[];for(var f=0;f<d.length;f++)l[d.charCodeAt(f)]=f}var x=d.charAt(64);if(x){var v=u.indexOf(x);v!==-1&&(h=v)}return a(u,h,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(u,c,h){for(var d=[],l=0,f=0;f<c;f++)if(f%4){var x=h[u.charCodeAt(f-1)]<<f%4*2,v=h[u.charCodeAt(f)]>>>6-f%4*2,g=x|v;d[l>>>2]|=g<<24-l%4*8,l++}return i.create(d,l)}}(),t.enc.Base64url})}(bs)),bs.exports}var Ss={exports:{}},_a;function St(){return _a||(_a=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,u=s.algo,c=[];(function(){for(var v=0;v<64;v++)c[v]=r.abs(r.sin(v+1))*4294967296|0})();var h=u.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,g){for(var E=0;E<16;E++){var p=g+E,m=v[p];v[p]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}var y=this._hash.words,A=v[g+0],w=v[g+1],D=v[g+2],_=v[g+3],L=v[g+4],C=v[g+5],B=v[g+6],S=v[g+7],T=v[g+8],V=v[g+9],$=v[g+10],K=v[g+11],ie=v[g+12],ee=v[g+13],re=v[g+14],ne=v[g+15],b=y[0],k=y[1],N=y[2],I=y[3];b=d(b,k,N,I,A,7,c[0]),I=d(I,b,k,N,w,12,c[1]),N=d(N,I,b,k,D,17,c[2]),k=d(k,N,I,b,_,22,c[3]),b=d(b,k,N,I,L,7,c[4]),I=d(I,b,k,N,C,12,c[5]),N=d(N,I,b,k,B,17,c[6]),k=d(k,N,I,b,S,22,c[7]),b=d(b,k,N,I,T,7,c[8]),I=d(I,b,k,N,V,12,c[9]),N=d(N,I,b,k,$,17,c[10]),k=d(k,N,I,b,K,22,c[11]),b=d(b,k,N,I,ie,7,c[12]),I=d(I,b,k,N,ee,12,c[13]),N=d(N,I,b,k,re,17,c[14]),k=d(k,N,I,b,ne,22,c[15]),b=l(b,k,N,I,w,5,c[16]),I=l(I,b,k,N,B,9,c[17]),N=l(N,I,b,k,K,14,c[18]),k=l(k,N,I,b,A,20,c[19]),b=l(b,k,N,I,C,5,c[20]),I=l(I,b,k,N,$,9,c[21]),N=l(N,I,b,k,ne,14,c[22]),k=l(k,N,I,b,L,20,c[23]),b=l(b,k,N,I,V,5,c[24]),I=l(I,b,k,N,re,9,c[25]),N=l(N,I,b,k,_,14,c[26]),k=l(k,N,I,b,T,20,c[27]),b=l(b,k,N,I,ee,5,c[28]),I=l(I,b,k,N,D,9,c[29]),N=l(N,I,b,k,S,14,c[30]),k=l(k,N,I,b,ie,20,c[31]),b=f(b,k,N,I,C,4,c[32]),I=f(I,b,k,N,T,11,c[33]),N=f(N,I,b,k,K,16,c[34]),k=f(k,N,I,b,re,23,c[35]),b=f(b,k,N,I,w,4,c[36]),I=f(I,b,k,N,L,11,c[37]),N=f(N,I,b,k,S,16,c[38]),k=f(k,N,I,b,$,23,c[39]),b=f(b,k,N,I,ee,4,c[40]),I=f(I,b,k,N,A,11,c[41]),N=f(N,I,b,k,_,16,c[42]),k=f(k,N,I,b,B,23,c[43]),b=f(b,k,N,I,V,4,c[44]),I=f(I,b,k,N,ie,11,c[45]),N=f(N,I,b,k,ne,16,c[46]),k=f(k,N,I,b,D,23,c[47]),b=x(b,k,N,I,A,6,c[48]),I=x(I,b,k,N,S,10,c[49]),N=x(N,I,b,k,re,15,c[50]),k=x(k,N,I,b,C,21,c[51]),b=x(b,k,N,I,ie,6,c[52]),I=x(I,b,k,N,_,10,c[53]),N=x(N,I,b,k,$,15,c[54]),k=x(k,N,I,b,w,21,c[55]),b=x(b,k,N,I,T,6,c[56]),I=x(I,b,k,N,ne,10,c[57]),N=x(N,I,b,k,B,15,c[58]),k=x(k,N,I,b,ee,21,c[59]),b=x(b,k,N,I,L,6,c[60]),I=x(I,b,k,N,K,10,c[61]),N=x(N,I,b,k,D,15,c[62]),k=x(k,N,I,b,V,21,c[63]),y[0]=y[0]+b|0,y[1]=y[1]+k|0,y[2]=y[2]+N|0,y[3]=y[3]+I|0},_doFinalize:function(){var v=this._data,g=v.words,E=this._nDataBytes*8,p=v.sigBytes*8;g[p>>>5]|=128<<24-p%32;var m=r.floor(E/4294967296),y=E;g[(p+64>>>9<<4)+15]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,g[(p+64>>>9<<4)+14]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,v.sigBytes=(g.length+1)*4,this._process();for(var A=this._hash,w=A.words,D=0;D<4;D++){var _=w[D];w[D]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360}return A},clone:function(){var v=a.clone.call(this);return v._hash=this._hash.clone(),v}});function d(v,g,E,p,m,y,A){var w=v+(g&E|~g&p)+m+A;return(w<<y|w>>>32-y)+g}function l(v,g,E,p,m,y,A){var w=v+(g&p|E&~p)+m+A;return(w<<y|w>>>32-y)+g}function f(v,g,E,p,m,y,A){var w=v+(g^E^p)+m+A;return(w<<y|w>>>32-y)+g}function x(v,g,E,p,m,y,A){var w=v+(E^(g|~p))+m+A;return(w<<y|w>>>32-y)+g}s.MD5=a._createHelper(h),s.HmacMD5=a._createHmacHelper(h)}(Math),t.MD5})}(Ss)),Ss.exports}var Ts={exports:{}},Fa;function cc(){return Fa||(Fa=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=s.Hasher,a=r.algo,u=[],c=a.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,d){for(var l=this._hash.words,f=l[0],x=l[1],v=l[2],g=l[3],E=l[4],p=0;p<80;p++){if(p<16)u[p]=h[d+p]|0;else{var m=u[p-3]^u[p-8]^u[p-14]^u[p-16];u[p]=m<<1|m>>>31}var y=(f<<5|f>>>27)+E+u[p];p<20?y+=(x&v|~x&g)+1518500249:p<40?y+=(x^v^g)+1859775393:p<60?y+=(x&v|x&g|v&g)-1894007588:y+=(x^v^g)-899497514,E=g,g=v,v=x<<30|x>>>2,x=f,f=y}l[0]=l[0]+f|0,l[1]=l[1]+x|0,l[2]=l[2]+v|0,l[3]=l[3]+g|0,l[4]=l[4]+E|0},_doFinalize:function(){var h=this._data,d=h.words,l=this._nDataBytes*8,f=h.sigBytes*8;return d[f>>>5]|=128<<24-f%32,d[(f+64>>>9<<4)+14]=Math.floor(l/4294967296),d[(f+64>>>9<<4)+15]=l,h.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var h=o.clone.call(this);return h._hash=this._hash.clone(),h}});r.SHA1=o._createHelper(c),r.HmacSHA1=o._createHmacHelper(c)}(),t.SHA1})}(Ts)),Ts.exports}var Is={exports:{}},ba;function Ji(){return ba||(ba=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,u=s.algo,c=[],h=[];(function(){function f(E){for(var p=r.sqrt(E),m=2;m<=p;m++)if(!(E%m))return!1;return!0}function x(E){return(E-(E|0))*4294967296|0}for(var v=2,g=0;g<64;)f(v)&&(g<8&&(c[g]=x(r.pow(v,1/2))),h[g]=x(r.pow(v,1/3)),g++),v++})();var d=[],l=u.SHA256=a.extend({_doReset:function(){this._hash=new o.init(c.slice(0))},_doProcessBlock:function(f,x){for(var v=this._hash.words,g=v[0],E=v[1],p=v[2],m=v[3],y=v[4],A=v[5],w=v[6],D=v[7],_=0;_<64;_++){if(_<16)d[_]=f[x+_]|0;else{var L=d[_-15],C=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,B=d[_-2],S=(B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10;d[_]=C+d[_-7]+S+d[_-16]}var T=y&A^~y&w,V=g&E^g&p^E&p,$=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),K=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),ie=D+K+T+h[_]+d[_],ee=$+V;D=w,w=A,A=y,y=m+ie|0,m=p,p=E,E=g,g=ie+ee|0}v[0]=v[0]+g|0,v[1]=v[1]+E|0,v[2]=v[2]+p|0,v[3]=v[3]+m|0,v[4]=v[4]+y|0,v[5]=v[5]+A|0,v[6]=v[6]+w|0,v[7]=v[7]+D|0},_doFinalize:function(){var f=this._data,x=f.words,v=this._nDataBytes*8,g=f.sigBytes*8;return x[g>>>5]|=128<<24-g%32,x[(g+64>>>9<<4)+14]=r.floor(v/4294967296),x[(g+64>>>9<<4)+15]=v,f.sigBytes=x.length*4,this._process(),this._hash},clone:function(){var f=a.clone.call(this);return f._hash=this._hash.clone(),f}});s.SHA256=a._createHelper(l),s.HmacSHA256=a._createHmacHelper(l)}(Math),t.SHA256})}(Is)),Is.exports}var ks={exports:{}},Sa;function il(){return Sa||(Sa=1,function(n,e){(function(t,r,s){n.exports=r(X(),Ji())})(G,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.algo,a=o.SHA256,u=o.SHA224=a.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(u),r.HmacSHA224=a._createHmacHelper(u)}(),t.SHA224})}(ks)),ks.exports}var Ns={exports:{}},Ta;function uc(){return Ta||(Ta=1,function(n,e){(function(t,r,s){n.exports=r(X(),qr())})(G,function(t){return function(){var r=t,s=r.lib,i=s.Hasher,o=r.x64,a=o.Word,u=o.WordArray,c=r.algo;function h(){return a.create.apply(a,arguments)}var d=[h(1116352408,3609767458),h(1899447441,602891725),h(3049323471,3964484399),h(3921009573,2173295548),h(961987163,4081628472),h(1508970993,3053834265),h(2453635748,2937671579),h(2870763221,3664609560),h(3624381080,2734883394),h(310598401,1164996542),h(607225278,1323610764),h(1426881987,3590304994),h(1925078388,4068182383),h(2162078206,991336113),h(2614888103,633803317),h(3248222580,3479774868),h(3835390401,2666613458),h(4022224774,944711139),h(264347078,2341262773),h(604807628,2007800933),h(770255983,1495990901),h(1249150122,1856431235),h(1555081692,3175218132),h(1996064986,2198950837),h(2554220882,3999719339),h(2821834349,766784016),h(2952996808,2566594879),h(3210313671,3203337956),h(3336571891,1034457026),h(3584528711,2466948901),h(113926993,3758326383),h(338241895,168717936),h(666307205,1188179964),h(773529912,1546045734),h(1294757372,1522805485),h(1396182291,2643833823),h(1695183700,2343527390),h(1986661051,1014477480),h(2177026350,1206759142),h(2456956037,344077627),h(2730485921,1290863460),h(2820302411,3158454273),h(3259730800,3505952657),h(3345764771,106217008),h(3516065817,3606008344),h(3600352804,1432725776),h(4094571909,1467031594),h(275423344,851169720),h(430227734,3100823752),h(506948616,1363258195),h(659060556,3750685593),h(883997877,3785050280),h(958139571,3318307427),h(1322822218,3812723403),h(1537002063,2003034995),h(1747873779,3602036899),h(1955562222,1575990012),h(2024104815,1125592928),h(2227730452,2716904306),h(2361852424,442776044),h(2428436474,593698344),h(2756734187,3733110249),h(3204031479,2999351573),h(3329325298,3815920427),h(3391569614,3928383900),h(3515267271,566280711),h(3940187606,3454069534),h(4118630271,4000239992),h(116418474,1914138554),h(174292421,2731055270),h(289380356,3203993006),h(460393269,320620315),h(685471733,587496836),h(852142971,1086792851),h(1017036298,365543100),h(1126000580,2618297676),h(1288033470,3409855158),h(1501505948,4234509866),h(1607167915,987167468),h(1816402316,1246189591)],l=[];(function(){for(var x=0;x<80;x++)l[x]=h()})();var f=c.SHA512=i.extend({_doReset:function(){this._hash=new u.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(x,v){for(var g=this._hash.words,E=g[0],p=g[1],m=g[2],y=g[3],A=g[4],w=g[5],D=g[6],_=g[7],L=E.high,C=E.low,B=p.high,S=p.low,T=m.high,V=m.low,$=y.high,K=y.low,ie=A.high,ee=A.low,re=w.high,ne=w.low,b=D.high,k=D.low,N=_.high,I=_.low,ue=L,se=C,ke=B,W=S,cn=T,Nt=V,Es=$,un=K,$e=ie,Re=ee,sr=re,hn=ne,ir=b,ln=k,Cs=N,fn=I,qe=0;qe<80;qe++){var Ve,rt,or=l[qe];if(qe<16)rt=or.high=x[v+qe*2]|0,Ve=or.low=x[v+qe*2+1]|0;else{var oa=l[qe-15],Rt=oa.high,dn=oa.low,Rh=(Rt>>>1|dn<<31)^(Rt>>>8|dn<<24)^Rt>>>7,aa=(dn>>>1|Rt<<31)^(dn>>>8|Rt<<24)^(dn>>>7|Rt<<25),ca=l[qe-2],Lt=ca.high,xn=ca.low,Lh=(Lt>>>19|xn<<13)^(Lt<<3|xn>>>29)^Lt>>>6,ua=(xn>>>19|Lt<<13)^(xn<<3|Lt>>>29)^(xn>>>6|Lt<<26),ha=l[qe-7],Oh=ha.high,Ph=ha.low,la=l[qe-16],Mh=la.high,fa=la.low;Ve=aa+Ph,rt=Rh+Oh+(Ve>>>0<aa>>>0?1:0),Ve=Ve+ua,rt=rt+Lh+(Ve>>>0<ua>>>0?1:0),Ve=Ve+fa,rt=rt+Mh+(Ve>>>0<fa>>>0?1:0),or.high=rt,or.low=Ve}var Vh=$e&sr^~$e&ir,da=Re&hn^~Re&ln,Uh=ue&ke^ue&cn^ke&cn,$h=se&W^se&Nt^W&Nt,qh=(ue>>>28|se<<4)^(ue<<30|se>>>2)^(ue<<25|se>>>7),xa=(se>>>28|ue<<4)^(se<<30|ue>>>2)^(se<<25|ue>>>7),Hh=($e>>>14|Re<<18)^($e>>>18|Re<<14)^($e<<23|Re>>>9),zh=(Re>>>14|$e<<18)^(Re>>>18|$e<<14)^(Re<<23|$e>>>9),pa=d[qe],jh=pa.high,ga=pa.low,Le=fn+zh,st=Cs+Hh+(Le>>>0<fn>>>0?1:0),Le=Le+da,st=st+Vh+(Le>>>0<da>>>0?1:0),Le=Le+ga,st=st+jh+(Le>>>0<ga>>>0?1:0),Le=Le+Ve,st=st+rt+(Le>>>0<Ve>>>0?1:0),ma=xa+$h,Kh=qh+Uh+(ma>>>0<xa>>>0?1:0);Cs=ir,fn=ln,ir=sr,ln=hn,sr=$e,hn=Re,Re=un+Le|0,$e=Es+st+(Re>>>0<un>>>0?1:0)|0,Es=cn,un=Nt,cn=ke,Nt=W,ke=ue,W=se,se=Le+ma|0,ue=st+Kh+(se>>>0<Le>>>0?1:0)|0}C=E.low=C+se,E.high=L+ue+(C>>>0<se>>>0?1:0),S=p.low=S+W,p.high=B+ke+(S>>>0<W>>>0?1:0),V=m.low=V+Nt,m.high=T+cn+(V>>>0<Nt>>>0?1:0),K=y.low=K+un,y.high=$+Es+(K>>>0<un>>>0?1:0),ee=A.low=ee+Re,A.high=ie+$e+(ee>>>0<Re>>>0?1:0),ne=w.low=ne+hn,w.high=re+sr+(ne>>>0<hn>>>0?1:0),k=D.low=k+ln,D.high=b+ir+(k>>>0<ln>>>0?1:0),I=_.low=I+fn,_.high=N+Cs+(I>>>0<fn>>>0?1:0)},_doFinalize:function(){var x=this._data,v=x.words,g=this._nDataBytes*8,E=x.sigBytes*8;v[E>>>5]|=128<<24-E%32,v[(E+128>>>10<<5)+30]=Math.floor(g/4294967296),v[(E+128>>>10<<5)+31]=g,x.sigBytes=v.length*4,this._process();var p=this._hash.toX32();return p},clone:function(){var x=i.clone.call(this);return x._hash=this._hash.clone(),x},blockSize:1024/32});r.SHA512=i._createHelper(f),r.HmacSHA512=i._createHmacHelper(f)}(),t.SHA512})}(Ns)),Ns.exports}var Rs={exports:{}},Ia;function ol(){return Ia||(Ia=1,function(n,e){(function(t,r,s){n.exports=r(X(),qr(),uc())})(G,function(t){return function(){var r=t,s=r.x64,i=s.Word,o=s.WordArray,a=r.algo,u=a.SHA512,c=a.SHA384=u.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var h=u._doFinalize.call(this);return h.sigBytes-=16,h}});r.SHA384=u._createHelper(c),r.HmacSHA384=u._createHmacHelper(c)}(),t.SHA384})}(Rs)),Rs.exports}var Ls={exports:{}},ka;function al(){return ka||(ka=1,function(n,e){(function(t,r,s){n.exports=r(X(),qr())})(G,function(t){return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,u=s.x64,c=u.Word,h=s.algo,d=[],l=[],f=[];(function(){for(var g=1,E=0,p=0;p<24;p++){d[g+5*E]=(p+1)*(p+2)/2%64;var m=E%5,y=(2*g+3*E)%5;g=m,E=y}for(var g=0;g<5;g++)for(var E=0;E<5;E++)l[g+5*E]=E+(2*g+3*E)%5*5;for(var A=1,w=0;w<24;w++){for(var D=0,_=0,L=0;L<7;L++){if(A&1){var C=(1<<L)-1;C<32?_^=1<<C:D^=1<<C-32}A&128?A=A<<1^113:A<<=1}f[w]=c.create(D,_)}})();var x=[];(function(){for(var g=0;g<25;g++)x[g]=c.create()})();var v=h.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var g=this._state=[],E=0;E<25;E++)g[E]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(g,E){for(var p=this._state,m=this.blockSize/2,y=0;y<m;y++){var A=g[E+2*y],w=g[E+2*y+1];A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360;var D=p[y];D.high^=w,D.low^=A}for(var _=0;_<24;_++){for(var L=0;L<5;L++){for(var C=0,B=0,S=0;S<5;S++){var D=p[L+5*S];C^=D.high,B^=D.low}var T=x[L];T.high=C,T.low=B}for(var L=0;L<5;L++)for(var V=x[(L+4)%5],$=x[(L+1)%5],K=$.high,ie=$.low,C=V.high^(K<<1|ie>>>31),B=V.low^(ie<<1|K>>>31),S=0;S<5;S++){var D=p[L+5*S];D.high^=C,D.low^=B}for(var ee=1;ee<25;ee++){var C,B,D=p[ee],re=D.high,ne=D.low,b=d[ee];b<32?(C=re<<b|ne>>>32-b,B=ne<<b|re>>>32-b):(C=ne<<b-32|re>>>64-b,B=re<<b-32|ne>>>64-b);var k=x[l[ee]];k.high=C,k.low=B}var N=x[0],I=p[0];N.high=I.high,N.low=I.low;for(var L=0;L<5;L++)for(var S=0;S<5;S++){var ee=L+5*S,D=p[ee],ue=x[ee],se=x[(L+1)%5+5*S],ke=x[(L+2)%5+5*S];D.high=ue.high^~se.high&ke.high,D.low=ue.low^~se.low&ke.low}var D=p[0],W=f[_];D.high^=W.high,D.low^=W.low}},_doFinalize:function(){var g=this._data,E=g.words;this._nDataBytes*8;var p=g.sigBytes*8,m=this.blockSize*32;E[p>>>5]|=1<<24-p%32,E[(r.ceil((p+1)/m)*m>>>5)-1]|=128,g.sigBytes=E.length*4,this._process();for(var y=this._state,A=this.cfg.outputLength/8,w=A/8,D=[],_=0;_<w;_++){var L=y[_],C=L.high,B=L.low;C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360,D.push(B),D.push(C)}return new o.init(D,A)},clone:function(){for(var g=a.clone.call(this),E=g._state=this._state.slice(0),p=0;p<25;p++)E[p]=E[p].clone();return g}});s.SHA3=a._createHelper(v),s.HmacSHA3=a._createHmacHelper(v)}(Math),t.SHA3})}(Ls)),Ls.exports}var Os={exports:{}},Na;function cl(){return Na||(Na=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,u=s.algo,c=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=o.create([0,1518500249,1859775393,2400959708,2840853838]),x=o.create([1352829926,1548603684,1836072691,2053994217,0]),v=u.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(w,D){for(var _=0;_<16;_++){var L=D+_,C=w[L];w[L]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}var B=this._hash.words,S=f.words,T=x.words,V=c.words,$=h.words,K=d.words,ie=l.words,ee,re,ne,b,k,N,I,ue,se,ke;N=ee=B[0],I=re=B[1],ue=ne=B[2],se=b=B[3],ke=k=B[4];for(var W,_=0;_<80;_+=1)W=ee+w[D+V[_]]|0,_<16?W+=g(re,ne,b)+S[0]:_<32?W+=E(re,ne,b)+S[1]:_<48?W+=p(re,ne,b)+S[2]:_<64?W+=m(re,ne,b)+S[3]:W+=y(re,ne,b)+S[4],W=W|0,W=A(W,K[_]),W=W+k|0,ee=k,k=b,b=A(ne,10),ne=re,re=W,W=N+w[D+$[_]]|0,_<16?W+=y(I,ue,se)+T[0]:_<32?W+=m(I,ue,se)+T[1]:_<48?W+=p(I,ue,se)+T[2]:_<64?W+=E(I,ue,se)+T[3]:W+=g(I,ue,se)+T[4],W=W|0,W=A(W,ie[_]),W=W+ke|0,N=ke,ke=se,se=A(ue,10),ue=I,I=W;W=B[1]+ne+se|0,B[1]=B[2]+b+ke|0,B[2]=B[3]+k+N|0,B[3]=B[4]+ee+I|0,B[4]=B[0]+re+ue|0,B[0]=W},_doFinalize:function(){var w=this._data,D=w.words,_=this._nDataBytes*8,L=w.sigBytes*8;D[L>>>5]|=128<<24-L%32,D[(L+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,w.sigBytes=(D.length+1)*4,this._process();for(var C=this._hash,B=C.words,S=0;S<5;S++){var T=B[S];B[S]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}return C},clone:function(){var w=a.clone.call(this);return w._hash=this._hash.clone(),w}});function g(w,D,_){return w^D^_}function E(w,D,_){return w&D|~w&_}function p(w,D,_){return(w|~D)^_}function m(w,D,_){return w&_|D&~_}function y(w,D,_){return w^(D|~_)}function A(w,D){return w<<D|w>>>32-D}s.RIPEMD160=a._createHelper(v),s.HmacRIPEMD160=a._createHmacHelper(v)}(),t.RIPEMD160})}(Os)),Os.exports}var Ps={exports:{}},Ra;function eo(){return Ra||(Ra=1,function(n,e){(function(t,r){n.exports=r(X())})(G,function(t){(function(){var r=t,s=r.lib,i=s.Base,o=r.enc,a=o.Utf8,u=r.algo;u.HMAC=i.extend({init:function(c,h){c=this._hasher=new c.init,typeof h=="string"&&(h=a.parse(h));var d=c.blockSize,l=d*4;h.sigBytes>l&&(h=c.finalize(h)),h.clamp();for(var f=this._oKey=h.clone(),x=this._iKey=h.clone(),v=f.words,g=x.words,E=0;E<d;E++)v[E]^=1549556828,g[E]^=909522486;f.sigBytes=x.sigBytes=l,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var h=this._hasher,d=h.finalize(c);h.reset();var l=h.finalize(this._oKey.clone().concat(d));return l}})})()})}(Ps)),Ps.exports}var Ms={exports:{}},La;function ul(){return La||(La=1,function(n,e){(function(t,r,s){n.exports=r(X(),Ji(),eo())})(G,function(t){return function(){var r=t,s=r.lib,i=s.Base,o=s.WordArray,a=r.algo,u=a.SHA256,c=a.HMAC,h=a.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:u,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,l){for(var f=this.cfg,x=c.create(f.hasher,d),v=o.create(),g=o.create([1]),E=v.words,p=g.words,m=f.keySize,y=f.iterations;E.length<m;){var A=x.update(l).finalize(g);x.reset();for(var w=A.words,D=w.length,_=A,L=1;L<y;L++){_=x.finalize(_),x.reset();for(var C=_.words,B=0;B<D;B++)w[B]^=C[B]}v.concat(A),p[0]++}return v.sigBytes=m*4,v}});r.PBKDF2=function(d,l,f){return h.create(f).compute(d,l)}}(),t.PBKDF2})}(Ms)),Ms.exports}var Vs={exports:{}},Oa;function dt(){return Oa||(Oa=1,function(n,e){(function(t,r,s){n.exports=r(X(),cc(),eo())})(G,function(t){return function(){var r=t,s=r.lib,i=s.Base,o=s.WordArray,a=r.algo,u=a.MD5,c=a.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:u,iterations:1}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,d){for(var l,f=this.cfg,x=f.hasher.create(),v=o.create(),g=v.words,E=f.keySize,p=f.iterations;g.length<E;){l&&x.update(l),l=x.update(h).finalize(d),x.reset();for(var m=1;m<p;m++)l=x.finalize(l),x.reset();v.concat(l)}return v.sigBytes=E*4,v}});r.EvpKDF=function(h,d,l){return c.create(l).compute(h,d)}}(),t.EvpKDF})}(Vs)),Vs.exports}var Us={exports:{}},Pa;function ve(){return Pa||(Pa=1,function(n,e){(function(t,r,s){n.exports=r(X(),dt())})(G,function(t){t.lib.Cipher||function(r){var s=t,i=s.lib,o=i.Base,a=i.WordArray,u=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var h=c.Base64,d=s.algo,l=d.EvpKDF,f=i.Cipher=u.extend({cfg:o.extend(),createEncryptor:function(C,B){return this.create(this._ENC_XFORM_MODE,C,B)},createDecryptor:function(C,B){return this.create(this._DEC_XFORM_MODE,C,B)},init:function(C,B,S){this.cfg=this.cfg.extend(S),this._xformMode=C,this._key=B,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(C){return this._append(C),this._process()},finalize:function(C){C&&this._append(C);var B=this._doFinalize();return B},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function C(B){return typeof B=="string"?L:w}return function(B){return{encrypt:function(S,T,V){return C(T).encrypt(B,S,T,V)},decrypt:function(S,T,V){return C(T).decrypt(B,S,T,V)}}}}()});i.StreamCipher=f.extend({_doFinalize:function(){var C=this._process(!0);return C},blockSize:1});var x=s.mode={},v=i.BlockCipherMode=o.extend({createEncryptor:function(C,B){return this.Encryptor.create(C,B)},createDecryptor:function(C,B){return this.Decryptor.create(C,B)},init:function(C,B){this._cipher=C,this._iv=B}}),g=x.CBC=function(){var C=v.extend();C.Encryptor=C.extend({processBlock:function(S,T){var V=this._cipher,$=V.blockSize;B.call(this,S,T,$),V.encryptBlock(S,T),this._prevBlock=S.slice(T,T+$)}}),C.Decryptor=C.extend({processBlock:function(S,T){var V=this._cipher,$=V.blockSize,K=S.slice(T,T+$);V.decryptBlock(S,T),B.call(this,S,T,$),this._prevBlock=K}});function B(S,T,V){var $,K=this._iv;K?($=K,this._iv=r):$=this._prevBlock;for(var ie=0;ie<V;ie++)S[T+ie]^=$[ie]}return C}(),E=s.pad={},p=E.Pkcs7={pad:function(C,B){for(var S=B*4,T=S-C.sigBytes%S,V=T<<24|T<<16|T<<8|T,$=[],K=0;K<T;K+=4)$.push(V);var ie=a.create($,T);C.concat(ie)},unpad:function(C){var B=C.words[C.sigBytes-1>>>2]&255;C.sigBytes-=B}};i.BlockCipher=f.extend({cfg:f.cfg.extend({mode:g,padding:p}),reset:function(){var C;f.reset.call(this);var B=this.cfg,S=B.iv,T=B.mode;this._xformMode==this._ENC_XFORM_MODE?C=T.createEncryptor:(C=T.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==C?this._mode.init(this,S&&S.words):(this._mode=C.call(T,this,S&&S.words),this._mode.__creator=C)},_doProcessBlock:function(C,B){this._mode.processBlock(C,B)},_doFinalize:function(){var C,B=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(B.pad(this._data,this.blockSize),C=this._process(!0)):(C=this._process(!0),B.unpad(C)),C},blockSize:128/32});var m=i.CipherParams=o.extend({init:function(C){this.mixIn(C)},toString:function(C){return(C||this.formatter).stringify(this)}}),y=s.format={},A=y.OpenSSL={stringify:function(C){var B,S=C.ciphertext,T=C.salt;return T?B=a.create([1398893684,1701076831]).concat(T).concat(S):B=S,B.toString(h)},parse:function(C){var B,S=h.parse(C),T=S.words;return T[0]==1398893684&&T[1]==1701076831&&(B=a.create(T.slice(2,4)),T.splice(0,4),S.sigBytes-=16),m.create({ciphertext:S,salt:B})}},w=i.SerializableCipher=o.extend({cfg:o.extend({format:A}),encrypt:function(C,B,S,T){T=this.cfg.extend(T);var V=C.createEncryptor(S,T),$=V.finalize(B),K=V.cfg;return m.create({ciphertext:$,key:S,iv:K.iv,algorithm:C,mode:K.mode,padding:K.padding,blockSize:C.blockSize,formatter:T.format})},decrypt:function(C,B,S,T){T=this.cfg.extend(T),B=this._parse(B,T.format);var V=C.createDecryptor(S,T).finalize(B.ciphertext);return V},_parse:function(C,B){return typeof C=="string"?B.parse(C,this):C}}),D=s.kdf={},_=D.OpenSSL={execute:function(C,B,S,T,V){if(T||(T=a.random(64/8)),V)var $=l.create({keySize:B+S,hasher:V}).compute(C,T);else var $=l.create({keySize:B+S}).compute(C,T);var K=a.create($.words.slice(B),S*4);return $.sigBytes=B*4,m.create({key:$,iv:K,salt:T})}},L=i.PasswordBasedCipher=w.extend({cfg:w.cfg.extend({kdf:_}),encrypt:function(C,B,S,T){T=this.cfg.extend(T);var V=T.kdf.execute(S,C.keySize,C.ivSize,T.salt,T.hasher);T.iv=V.iv;var $=w.encrypt.call(this,C,B,V.key,T);return $.mixIn(V),$},decrypt:function(C,B,S,T){T=this.cfg.extend(T),B=this._parse(B,T.format);var V=T.kdf.execute(S,C.keySize,C.ivSize,B.salt,T.hasher);T.iv=V.iv;var $=w.decrypt.call(this,C,B,V.key,T);return $}})}()})}(Us)),Us.exports}var $s={exports:{}},Ma;function hl(){return Ma||(Ma=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,o){var a=this._cipher,u=a.blockSize;s.call(this,i,o,u,a),this._prevBlock=i.slice(o,o+u)}}),r.Decryptor=r.extend({processBlock:function(i,o){var a=this._cipher,u=a.blockSize,c=i.slice(o,o+u);s.call(this,i,o,u,a),this._prevBlock=c}});function s(i,o,a,u){var c,h=this._iv;h?(c=h.slice(0),this._iv=void 0):c=this._prevBlock,u.encryptBlock(c,0);for(var d=0;d<a;d++)i[o+d]^=c[d]}return r}(),t.mode.CFB})}($s)),$s.exports}var qs={exports:{}},Va;function ll(){return Va||(Va=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(i,o){var a=this._cipher,u=a.blockSize,c=this._iv,h=this._counter;c&&(h=this._counter=c.slice(0),this._iv=void 0);var d=h.slice(0);a.encryptBlock(d,0),h[u-1]=h[u-1]+1|0;for(var l=0;l<u;l++)i[o+l]^=d[l]}});return r.Decryptor=s,r}(),t.mode.CTR})}(qs)),qs.exports}var Hs={exports:{}},Ua;function fl(){return Ua||(Ua=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function s(a){if((a>>24&255)===255){var u=a>>16&255,c=a>>8&255,h=a&255;u===255?(u=0,c===255?(c=0,h===255?h=0:++h):++c):++u,a=0,a+=u<<16,a+=c<<8,a+=h}else a+=1<<24;return a}function i(a){return(a[0]=s(a[0]))===0&&(a[1]=s(a[1])),a}var o=r.Encryptor=r.extend({processBlock:function(a,u){var c=this._cipher,h=c.blockSize,d=this._iv,l=this._counter;d&&(l=this._counter=d.slice(0),this._iv=void 0),i(l);var f=l.slice(0);c.encryptBlock(f,0);for(var x=0;x<h;x++)a[u+x]^=f[x]}});return r.Decryptor=o,r}(),t.mode.CTRGladman})}(Hs)),Hs.exports}var zs={exports:{}},$a;function dl(){return $a||($a=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(i,o){var a=this._cipher,u=a.blockSize,c=this._iv,h=this._keystream;c&&(h=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(h,0);for(var d=0;d<u;d++)i[o+d]^=h[d]}});return r.Decryptor=s,r}(),t.mode.OFB})}(zs)),zs.exports}var js={exports:{}},qa;function xl(){return qa||(qa=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),r.Decryptor=r.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),r}(),t.mode.ECB})}(js)),js.exports}var Ks={exports:{}},Ha;function pl(){return Ha||(Ha=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.pad.AnsiX923={pad:function(r,s){var i=r.sigBytes,o=s*4,a=o-i%o,u=i+a-1;r.clamp(),r.words[u>>>2]|=a<<24-u%4*8,r.sigBytes+=a},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Ansix923})}(Ks)),Ks.exports}var Gs={exports:{}},za;function gl(){return za||(za=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.pad.Iso10126={pad:function(r,s){var i=s*4,o=i-r.sigBytes%i;r.concat(t.lib.WordArray.random(o-1)).concat(t.lib.WordArray.create([o<<24],1))},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Iso10126})}(Gs)),Gs.exports}var Ws={exports:{}},ja;function ml(){return ja||(ja=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.pad.Iso97971={pad:function(r,s){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,s)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(Ws)),Ws.exports}var Qs={exports:{}},Ka;function vl(){return Ka||(Ka=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.pad.ZeroPadding={pad:function(r,s){var i=s*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var s=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},t.pad.ZeroPadding})}(Qs)),Qs.exports}var Xs={exports:{}},Ga;function yl(){return Ga||(Ga=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(Xs)),Xs.exports}var Ys={exports:{}},Wa;function El(){return Wa||(Wa=1,function(n,e){(function(t,r,s){n.exports=r(X(),ve())})(G,function(t){return function(r){var s=t,i=s.lib,o=i.CipherParams,a=s.enc,u=a.Hex,c=s.format;c.Hex={stringify:function(h){return h.ciphertext.toString(u)},parse:function(h){var d=u.parse(h);return o.create({ciphertext:d})}}}(),t.format.Hex})}(Ys)),Ys.exports}var Zs={exports:{}},Qa;function Cl(){return Qa||(Qa=1,function(n,e){(function(t,r,s){n.exports=r(X(),bt(),St(),dt(),ve())})(G,function(t){return function(){var r=t,s=r.lib,i=s.BlockCipher,o=r.algo,a=[],u=[],c=[],h=[],d=[],l=[],f=[],x=[],v=[],g=[];(function(){for(var m=[],y=0;y<256;y++)y<128?m[y]=y<<1:m[y]=y<<1^283;for(var A=0,w=0,y=0;y<256;y++){var D=w^w<<1^w<<2^w<<3^w<<4;D=D>>>8^D&255^99,a[A]=D,u[D]=A;var _=m[A],L=m[_],C=m[L],B=m[D]*257^D*16843008;c[A]=B<<24|B>>>8,h[A]=B<<16|B>>>16,d[A]=B<<8|B>>>24,l[A]=B;var B=C*16843009^L*65537^_*257^A*16843008;f[D]=B<<24|B>>>8,x[D]=B<<16|B>>>16,v[D]=B<<8|B>>>24,g[D]=B,A?(A=_^m[m[m[C^_]]],w^=m[m[w]]):A=w=1}})();var E=[0,1,2,4,8,16,32,64,128,27,54],p=o.AES=i.extend({_doReset:function(){var m;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var y=this._keyPriorReset=this._key,A=y.words,w=y.sigBytes/4,D=this._nRounds=w+6,_=(D+1)*4,L=this._keySchedule=[],C=0;C<_;C++)C<w?L[C]=A[C]:(m=L[C-1],C%w?w>6&&C%w==4&&(m=a[m>>>24]<<24|a[m>>>16&255]<<16|a[m>>>8&255]<<8|a[m&255]):(m=m<<8|m>>>24,m=a[m>>>24]<<24|a[m>>>16&255]<<16|a[m>>>8&255]<<8|a[m&255],m^=E[C/w|0]<<24),L[C]=L[C-w]^m);for(var B=this._invKeySchedule=[],S=0;S<_;S++){var C=_-S;if(S%4)var m=L[C];else var m=L[C-4];S<4||C<=4?B[S]=m:B[S]=f[a[m>>>24]]^x[a[m>>>16&255]]^v[a[m>>>8&255]]^g[a[m&255]]}}},encryptBlock:function(m,y){this._doCryptBlock(m,y,this._keySchedule,c,h,d,l,a)},decryptBlock:function(m,y){var A=m[y+1];m[y+1]=m[y+3],m[y+3]=A,this._doCryptBlock(m,y,this._invKeySchedule,f,x,v,g,u);var A=m[y+1];m[y+1]=m[y+3],m[y+3]=A},_doCryptBlock:function(m,y,A,w,D,_,L,C){for(var B=this._nRounds,S=m[y]^A[0],T=m[y+1]^A[1],V=m[y+2]^A[2],$=m[y+3]^A[3],K=4,ie=1;ie<B;ie++){var ee=w[S>>>24]^D[T>>>16&255]^_[V>>>8&255]^L[$&255]^A[K++],re=w[T>>>24]^D[V>>>16&255]^_[$>>>8&255]^L[S&255]^A[K++],ne=w[V>>>24]^D[$>>>16&255]^_[S>>>8&255]^L[T&255]^A[K++],b=w[$>>>24]^D[S>>>16&255]^_[T>>>8&255]^L[V&255]^A[K++];S=ee,T=re,V=ne,$=b}var ee=(C[S>>>24]<<24|C[T>>>16&255]<<16|C[V>>>8&255]<<8|C[$&255])^A[K++],re=(C[T>>>24]<<24|C[V>>>16&255]<<16|C[$>>>8&255]<<8|C[S&255])^A[K++],ne=(C[V>>>24]<<24|C[$>>>16&255]<<16|C[S>>>8&255]<<8|C[T&255])^A[K++],b=(C[$>>>24]<<24|C[S>>>16&255]<<16|C[T>>>8&255]<<8|C[V&255])^A[K++];m[y]=ee,m[y+1]=re,m[y+2]=ne,m[y+3]=b},keySize:256/32});r.AES=i._createHelper(p)}(),t.AES})}(Zs)),Zs.exports}var Js={exports:{}},Xa;function wl(){return Xa||(Xa=1,function(n,e){(function(t,r,s){n.exports=r(X(),bt(),St(),dt(),ve())})(G,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=s.BlockCipher,a=r.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=a.DES=o.extend({_doReset:function(){for(var E=this._key,p=E.words,m=[],y=0;y<56;y++){var A=u[y]-1;m[y]=p[A>>>5]>>>31-A%32&1}for(var w=this._subKeys=[],D=0;D<16;D++){for(var _=w[D]=[],L=h[D],y=0;y<24;y++)_[y/6|0]|=m[(c[y]-1+L)%28]<<31-y%6,_[4+(y/6|0)]|=m[28+(c[y+24]-1+L)%28]<<31-y%6;_[0]=_[0]<<1|_[0]>>>31;for(var y=1;y<7;y++)_[y]=_[y]>>>(y-1)*4+3;_[7]=_[7]<<5|_[7]>>>27}for(var C=this._invSubKeys=[],y=0;y<16;y++)C[y]=w[15-y]},encryptBlock:function(E,p){this._doCryptBlock(E,p,this._subKeys)},decryptBlock:function(E,p){this._doCryptBlock(E,p,this._invSubKeys)},_doCryptBlock:function(E,p,m){this._lBlock=E[p],this._rBlock=E[p+1],x.call(this,4,252645135),x.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),x.call(this,1,1431655765);for(var y=0;y<16;y++){for(var A=m[y],w=this._lBlock,D=this._rBlock,_=0,L=0;L<8;L++)_|=d[L][((D^A[L])&l[L])>>>0];this._lBlock=D,this._rBlock=w^_}var C=this._lBlock;this._lBlock=this._rBlock,this._rBlock=C,x.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),x.call(this,16,65535),x.call(this,4,252645135),E[p]=this._lBlock,E[p+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function x(E,p){var m=(this._lBlock>>>E^this._rBlock)&p;this._rBlock^=m,this._lBlock^=m<<E}function v(E,p){var m=(this._rBlock>>>E^this._lBlock)&p;this._lBlock^=m,this._rBlock^=m<<E}r.DES=o._createHelper(f);var g=a.TripleDES=o.extend({_doReset:function(){var E=this._key,p=E.words;if(p.length!==2&&p.length!==4&&p.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var m=p.slice(0,2),y=p.length<4?p.slice(0,2):p.slice(2,4),A=p.length<6?p.slice(0,2):p.slice(4,6);this._des1=f.createEncryptor(i.create(m)),this._des2=f.createEncryptor(i.create(y)),this._des3=f.createEncryptor(i.create(A))},encryptBlock:function(E,p){this._des1.encryptBlock(E,p),this._des2.decryptBlock(E,p),this._des3.encryptBlock(E,p)},decryptBlock:function(E,p){this._des3.decryptBlock(E,p),this._des2.encryptBlock(E,p),this._des1.decryptBlock(E,p)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(g)}(),t.TripleDES})}(Js)),Js.exports}var ei={exports:{}},Ya;function Al(){return Ya||(Ya=1,function(n,e){(function(t,r,s){n.exports=r(X(),bt(),St(),dt(),ve())})(G,function(t){return function(){var r=t,s=r.lib,i=s.StreamCipher,o=r.algo,a=o.RC4=i.extend({_doReset:function(){for(var h=this._key,d=h.words,l=h.sigBytes,f=this._S=[],x=0;x<256;x++)f[x]=x;for(var x=0,v=0;x<256;x++){var g=x%l,E=d[g>>>2]>>>24-g%4*8&255;v=(v+f[x]+E)%256;var p=f[x];f[x]=f[v],f[v]=p}this._i=this._j=0},_doProcessBlock:function(h,d){h[d]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var h=this._S,d=this._i,l=this._j,f=0,x=0;x<4;x++){d=(d+1)%256,l=(l+h[d])%256;var v=h[d];h[d]=h[l],h[l]=v,f|=h[(h[d]+h[l])%256]<<24-x*8}return this._i=d,this._j=l,f}r.RC4=i._createHelper(a);var c=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var h=this.cfg.drop;h>0;h--)u.call(this)}});r.RC4Drop=i._createHelper(c)}(),t.RC4})}(ei)),ei.exports}var ti={exports:{}},Za;function Dl(){return Za||(Za=1,function(n,e){(function(t,r,s){n.exports=r(X(),bt(),St(),dt(),ve())})(G,function(t){return function(){var r=t,s=r.lib,i=s.StreamCipher,o=r.algo,a=[],u=[],c=[],h=o.Rabbit=i.extend({_doReset:function(){for(var l=this._key.words,f=this.cfg.iv,x=0;x<4;x++)l[x]=(l[x]<<8|l[x]>>>24)&16711935|(l[x]<<24|l[x]>>>8)&4278255360;var v=this._X=[l[0],l[3]<<16|l[2]>>>16,l[1],l[0]<<16|l[3]>>>16,l[2],l[1]<<16|l[0]>>>16,l[3],l[2]<<16|l[1]>>>16],g=this._C=[l[2]<<16|l[2]>>>16,l[0]&4294901760|l[1]&65535,l[3]<<16|l[3]>>>16,l[1]&4294901760|l[2]&65535,l[0]<<16|l[0]>>>16,l[2]&4294901760|l[3]&65535,l[1]<<16|l[1]>>>16,l[3]&4294901760|l[0]&65535];this._b=0;for(var x=0;x<4;x++)d.call(this);for(var x=0;x<8;x++)g[x]^=v[x+4&7];if(f){var E=f.words,p=E[0],m=E[1],y=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,A=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,w=y>>>16|A&4294901760,D=A<<16|y&65535;g[0]^=y,g[1]^=w,g[2]^=A,g[3]^=D,g[4]^=y,g[5]^=w,g[6]^=A,g[7]^=D;for(var x=0;x<4;x++)d.call(this)}},_doProcessBlock:function(l,f){var x=this._X;d.call(this),a[0]=x[0]^x[5]>>>16^x[3]<<16,a[1]=x[2]^x[7]>>>16^x[5]<<16,a[2]=x[4]^x[1]>>>16^x[7]<<16,a[3]=x[6]^x[3]>>>16^x[1]<<16;for(var v=0;v<4;v++)a[v]=(a[v]<<8|a[v]>>>24)&16711935|(a[v]<<24|a[v]>>>8)&4278255360,l[f+v]^=a[v]},blockSize:128/32,ivSize:64/32});function d(){for(var l=this._X,f=this._C,x=0;x<8;x++)u[x]=f[x];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<u[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<u[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<u[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<u[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<u[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<u[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<u[6]>>>0?1:0)|0,this._b=f[7]>>>0<u[7]>>>0?1:0;for(var x=0;x<8;x++){var v=l[x]+f[x],g=v&65535,E=v>>>16,p=((g*g>>>17)+g*E>>>15)+E*E,m=((v&4294901760)*v|0)+((v&65535)*v|0);c[x]=p^m}l[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,l[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,l[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,l[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,l[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,l[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,l[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,l[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=i._createHelper(h)}(),t.Rabbit})}(ti)),ti.exports}var ni={exports:{}},Ja;function Bl(){return Ja||(Ja=1,function(n,e){(function(t,r,s){n.exports=r(X(),bt(),St(),dt(),ve())})(G,function(t){return function(){var r=t,s=r.lib,i=s.StreamCipher,o=r.algo,a=[],u=[],c=[],h=o.RabbitLegacy=i.extend({_doReset:function(){var l=this._key.words,f=this.cfg.iv,x=this._X=[l[0],l[3]<<16|l[2]>>>16,l[1],l[0]<<16|l[3]>>>16,l[2],l[1]<<16|l[0]>>>16,l[3],l[2]<<16|l[1]>>>16],v=this._C=[l[2]<<16|l[2]>>>16,l[0]&4294901760|l[1]&65535,l[3]<<16|l[3]>>>16,l[1]&4294901760|l[2]&65535,l[0]<<16|l[0]>>>16,l[2]&4294901760|l[3]&65535,l[1]<<16|l[1]>>>16,l[3]&4294901760|l[0]&65535];this._b=0;for(var g=0;g<4;g++)d.call(this);for(var g=0;g<8;g++)v[g]^=x[g+4&7];if(f){var E=f.words,p=E[0],m=E[1],y=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,A=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,w=y>>>16|A&4294901760,D=A<<16|y&65535;v[0]^=y,v[1]^=w,v[2]^=A,v[3]^=D,v[4]^=y,v[5]^=w,v[6]^=A,v[7]^=D;for(var g=0;g<4;g++)d.call(this)}},_doProcessBlock:function(l,f){var x=this._X;d.call(this),a[0]=x[0]^x[5]>>>16^x[3]<<16,a[1]=x[2]^x[7]>>>16^x[5]<<16,a[2]=x[4]^x[1]>>>16^x[7]<<16,a[3]=x[6]^x[3]>>>16^x[1]<<16;for(var v=0;v<4;v++)a[v]=(a[v]<<8|a[v]>>>24)&16711935|(a[v]<<24|a[v]>>>8)&4278255360,l[f+v]^=a[v]},blockSize:128/32,ivSize:64/32});function d(){for(var l=this._X,f=this._C,x=0;x<8;x++)u[x]=f[x];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<u[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<u[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<u[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<u[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<u[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<u[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<u[6]>>>0?1:0)|0,this._b=f[7]>>>0<u[7]>>>0?1:0;for(var x=0;x<8;x++){var v=l[x]+f[x],g=v&65535,E=v>>>16,p=((g*g>>>17)+g*E>>>15)+E*E,m=((v&4294901760)*v|0)+((v&65535)*v|0);c[x]=p^m}l[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,l[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,l[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,l[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,l[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,l[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,l[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,l[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=i._createHelper(h)}(),t.RabbitLegacy})}(ni)),ni.exports}var ri={exports:{}},e0;function _l(){return e0||(e0=1,function(n,e){(function(t,r,s){n.exports=r(X(),bt(),St(),dt(),ve())})(G,function(t){return function(){var r=t,s=r.lib,i=s.BlockCipher,o=r.algo;const a=16,u=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var h={pbox:[],sbox:[]};function d(g,E){let p=E>>24&255,m=E>>16&255,y=E>>8&255,A=E&255,w=g.sbox[0][p]+g.sbox[1][m];return w=w^g.sbox[2][y],w=w+g.sbox[3][A],w}function l(g,E,p){let m=E,y=p,A;for(let w=0;w<a;++w)m=m^g.pbox[w],y=d(g,m)^y,A=m,m=y,y=A;return A=m,m=y,y=A,y=y^g.pbox[a],m=m^g.pbox[a+1],{left:m,right:y}}function f(g,E,p){let m=E,y=p,A;for(let w=a+1;w>1;--w)m=m^g.pbox[w],y=d(g,m)^y,A=m,m=y,y=A;return A=m,m=y,y=A,y=y^g.pbox[1],m=m^g.pbox[0],{left:m,right:y}}function x(g,E,p){for(let D=0;D<4;D++){g.sbox[D]=[];for(let _=0;_<256;_++)g.sbox[D][_]=c[D][_]}let m=0;for(let D=0;D<a+2;D++)g.pbox[D]=u[D]^E[m],m++,m>=p&&(m=0);let y=0,A=0,w=0;for(let D=0;D<a+2;D+=2)w=l(g,y,A),y=w.left,A=w.right,g.pbox[D]=y,g.pbox[D+1]=A;for(let D=0;D<4;D++)for(let _=0;_<256;_+=2)w=l(g,y,A),y=w.left,A=w.right,g.sbox[D][_]=y,g.sbox[D][_+1]=A;return!0}var v=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var g=this._keyPriorReset=this._key,E=g.words,p=g.sigBytes/4;x(h,E,p)}},encryptBlock:function(g,E){var p=l(h,g[E],g[E+1]);g[E]=p.left,g[E+1]=p.right},decryptBlock:function(g,E){var p=f(h,g[E],g[E+1]);g[E]=p.left,g[E+1]=p.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=i._createHelper(v)}(),t.Blowfish})}(ri)),ri.exports}(function(n,e){(function(t,r,s){n.exports=r(X(),qr(),nl(),rl(),bt(),sl(),St(),cc(),Ji(),il(),uc(),ol(),al(),cl(),eo(),ul(),dt(),ve(),hl(),ll(),fl(),dl(),xl(),pl(),gl(),ml(),vl(),yl(),El(),Cl(),wl(),Al(),Dl(),Bl(),_l())})(G,function(t){return t})})(ac);var Fl=ac.exports;const bl=Wh(Fl),Sl="",t0=n=>bl.HmacSHA1(n,Sl).toString();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Tl=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},lc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,u=s+2<n.length,c=u?n[s+2]:0,h=i>>2,d=(i&3)<<4|a>>4;let l=(a&15)<<2|c>>6,f=c&63;u||(f=64,o||(l=64)),r.push(t[h],t[d],t[l],t[f])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(hc(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Tl(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||d==null)throw new Il;const l=i<<2|a>>4;if(r.push(l),c!==64){const f=a<<4&240|c>>2;if(r.push(f),d!==64){const x=c<<6&192|d;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Il extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kl=function(n){const e=hc(n);return lc.encodeByteArray(e,!0)},Dr=function(n){return kl(n).replace(/\./g,"")},Nl=function(n){try{return lc.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=()=>Rl().__FIREBASE_DEFAULTS__,Ol=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Pl=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Nl(n[1]);return e&&JSON.parse(e)},fc=()=>{try{return Ll()||Ol()||Pl()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ml=n=>{var e,t;return(t=(e=fc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Vl=n=>{const e=Ml(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},dc=()=>{var n;return(n=fc())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Dr(JSON.stringify(t)),Dr(JSON.stringify(o)),a].join(".")}function ql(){try{return typeof indexedDB=="object"}catch{return!1}}function Hl(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl="FirebaseError";class en extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=zl,Object.setPrototypeOf(this,en.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xc.prototype.create)}}class xc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?jl(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new en(s,a,r)}}function jl(n,e){return n.replace(Kl,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Kl=/\{\$([^}]+)}/g;function wi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(n0(i)&&n0(o)){if(!wi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function n0(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(n){return n&&n._delegate?n._delegate:n}class Bn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Ul;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ql(e))try{this.getOrInitializeService({instanceIdentifier:vt})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=vt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vt){return this.instances.has(e)}getOptions(e=vt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Wl(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=vt){return this.component?this.component.multipleInstances?e:vt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wl(n){return n===vt?void 0:n}function Ql(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Gl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var J;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(J||(J={}));const Yl={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},Zl=J.INFO,Jl={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},ef=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=Jl[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pc{constructor(e){this.name=e,this._logLevel=Zl,this._logHandler=ef,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yl[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}}const tf=(n,e)=>e.some(t=>n instanceof t);let r0,s0;function nf(){return r0||(r0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rf(){return s0||(s0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gc=new WeakMap,Ai=new WeakMap,mc=new WeakMap,si=new WeakMap,to=new WeakMap;function sf(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(ot(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&gc.set(t,n)}).catch(()=>{}),to.set(e,n),e}function of(n){if(Ai.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Ai.set(n,e)}let Di={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ai.get(n);if(e==="objectStoreNames")return n.objectStoreNames||mc.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ot(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function af(n){Di=n(Di)}function cf(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ii(this),e,...t);return mc.set(r,e.sort?e.sort():[e]),ot(r)}:rf().includes(n)?function(...e){return n.apply(ii(this),e),ot(gc.get(this))}:function(...e){return ot(n.apply(ii(this),e))}}function uf(n){return typeof n=="function"?cf(n):(n instanceof IDBTransaction&&of(n),tf(n,nf())?new Proxy(n,Di):n)}function ot(n){if(n instanceof IDBRequest)return sf(n);if(si.has(n))return si.get(n);const e=uf(n);return e!==n&&(si.set(n,e),to.set(e,n)),e}const ii=n=>to.get(n);function hf(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=ot(o);return r&&o.addEventListener("upgradeneeded",u=>{r(ot(o.result),u.oldVersion,u.newVersion,ot(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const lf=["get","getKey","getAll","getAllKeys","count"],ff=["put","add","delete","clear"],oi=new Map;function i0(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(oi.get(e))return oi.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=ff.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||lf.includes(t)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&u.done]))[0]};return oi.set(e,i),i}af(n=>({...n,get:(e,t,r)=>i0(e,t)||n.get(e,t,r),has:(e,t)=>!!i0(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(xf(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function xf(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bi="@firebase/app",o0="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At=new pc("@firebase/app"),pf="@firebase/app-compat",gf="@firebase/analytics-compat",mf="@firebase/analytics",vf="@firebase/app-check-compat",yf="@firebase/app-check",Ef="@firebase/auth",Cf="@firebase/auth-compat",wf="@firebase/database",Af="@firebase/database-compat",Df="@firebase/functions",Bf="@firebase/functions-compat",_f="@firebase/installations",Ff="@firebase/installations-compat",bf="@firebase/messaging",Sf="@firebase/messaging-compat",Tf="@firebase/performance",If="@firebase/performance-compat",kf="@firebase/remote-config",Nf="@firebase/remote-config-compat",Rf="@firebase/storage",Lf="@firebase/storage-compat",Of="@firebase/firestore",Pf="@firebase/firestore-compat",Mf="firebase",Vf="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i="[DEFAULT]",Uf={[Bi]:"fire-core",[pf]:"fire-core-compat",[mf]:"fire-analytics",[gf]:"fire-analytics-compat",[yf]:"fire-app-check",[vf]:"fire-app-check-compat",[Ef]:"fire-auth",[Cf]:"fire-auth-compat",[wf]:"fire-rtdb",[Af]:"fire-rtdb-compat",[Df]:"fire-fn",[Bf]:"fire-fn-compat",[_f]:"fire-iid",[Ff]:"fire-iid-compat",[bf]:"fire-fcm",[Sf]:"fire-fcm-compat",[Tf]:"fire-perf",[If]:"fire-perf-compat",[kf]:"fire-rc",[Nf]:"fire-rc-compat",[Rf]:"fire-gcs",[Lf]:"fire-gcs-compat",[Of]:"fire-fst",[Pf]:"fire-fst-compat","fire-js":"fire-js",[Mf]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=new Map,Fi=new Map;function $f(n,e){try{n.container.addComponent(e)}catch(t){At.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function _r(n){const e=n.name;if(Fi.has(e))return At.debug(`There were multiple attempts to register component ${e}.`),!1;Fi.set(e,n);for(const t of Br.values())$f(t,n);return!0}function qf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},at=new xc("app","Firebase",Hf);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Bn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw at.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf=Vf;function vc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:_i,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw at.create("bad-app-name",{appName:String(s)});if(t||(t=dc()),!t)throw at.create("no-options");const i=Br.get(s);if(i){if(wi(t,i.options)&&wi(r,i.config))return i;throw at.create("duplicate-app",{appName:s})}const o=new Xl(s);for(const u of Fi.values())o.addComponent(u);const a=new zf(t,r,o);return Br.set(s,a),a}function Kf(n=_i){const e=Br.get(n);if(!e&&n===_i&&dc())return vc();if(!e)throw at.create("no-app",{appName:n});return e}function Ut(n,e,t){var r;let s=(r=Uf[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),At.warn(a.join(" "));return}_r(new Bn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="firebase-heartbeat-database",Wf=1,_n="firebase-heartbeat-store";let ai=null;function yc(){return ai||(ai=hf(Gf,Wf,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(_n)}}}).catch(n=>{throw at.create("idb-open",{originalErrorMessage:n.message})})),ai}async function Qf(n){try{return await(await yc()).transaction(_n).objectStore(_n).get(Ec(n))}catch(e){if(e instanceof en)At.warn(e.message);else{const t=at.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});At.warn(t.message)}}}async function a0(n,e){try{const r=(await yc()).transaction(_n,"readwrite");await r.objectStore(_n).put(e,Ec(n)),await r.done}catch(t){if(t instanceof en)At.warn(t.message);else{const r=at.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});At.warn(r.message)}}}function Ec(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf=1024,Yf=30*24*60*60*1e3;class Zf{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ed(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=c0();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Yf}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=c0(),{heartbeatsToSend:t,unsentEntries:r}=Jf(this._heartbeatsCache.heartbeats),s=Dr(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function c0(){return new Date().toISOString().substring(0,10)}function Jf(n,e=Xf){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),u0(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),u0(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class ed{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ql()?Hl().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Qf(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return a0(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return a0(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function u0(n){return Dr(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(n){_r(new Bn("platform-logger",e=>new df(e),"PRIVATE")),_r(new Bn("heartbeat",e=>new Zf(e),"PRIVATE")),Ut(Bi,o0,n),Ut(Bi,o0,"esm2017"),Ut("fire-js","")}td("");var nd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},O,no=no||{},H=nd||self;function Hr(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function $n(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function rd(n){return Object.prototype.hasOwnProperty.call(n,ci)&&n[ci]||(n[ci]=++sd)}var ci="closure_uid_"+(1e9*Math.random()>>>0),sd=0;function id(n,e,t){return n.call.apply(n.bind,arguments)}function od(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(e,s)}}return function(){return n.apply(e,arguments)}}function Fe(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Fe=id:Fe=od,Fe.apply(null,arguments)}function ar(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ye(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function xt(){this.s=this.s,this.o=this.o}var ad=0;xt.prototype.s=!1;xt.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),ad!=0)&&rd(this)};xt.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Cc=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function ro(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function h0(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Hr(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function be(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}be.prototype.h=function(){this.defaultPrevented=!0};var cd=function(){if(!H.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{H.addEventListener("test",()=>{},e),H.removeEventListener("test",()=>{},e)}catch{}return n}();function Fn(n){return/^[\s\xa0]*$/.test(n)}function zr(){var n=H.navigator;return n&&(n=n.userAgent)?n:""}function Ke(n){return zr().indexOf(n)!=-1}function so(n){return so[" "](n),n}so[" "]=function(){};function ud(n,e){var t=tx;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var hd=Ke("Opera"),Kt=Ke("Trident")||Ke("MSIE"),wc=Ke("Edge"),bi=wc||Kt,Ac=Ke("Gecko")&&!(zr().toLowerCase().indexOf("webkit")!=-1&&!Ke("Edge"))&&!(Ke("Trident")||Ke("MSIE"))&&!Ke("Edge"),ld=zr().toLowerCase().indexOf("webkit")!=-1&&!Ke("Edge");function Dc(){var n=H.document;return n?n.documentMode:void 0}var Si;e:{var ui="",hi=function(){var n=zr();if(Ac)return/rv:([^\);]+)(\)|;)/.exec(n);if(wc)return/Edge\/([\d\.]+)/.exec(n);if(Kt)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(ld)return/WebKit\/(\S+)/.exec(n);if(hd)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(hi&&(ui=hi?hi[1]:""),Kt){var li=Dc();if(li!=null&&li>parseFloat(ui)){Si=String(li);break e}}Si=ui}var Ti;if(H.document&&Kt){var l0=Dc();Ti=l0||parseInt(Si,10)||void 0}else Ti=void 0;var fd=Ti;function bn(n,e){if(be.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Ac){e:{try{so(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:dd[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&bn.$.h.call(this)}}ye(bn,be);var dd={2:"touch",3:"pen",4:"mouse"};bn.prototype.h=function(){bn.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var qn="closure_listenable_"+(1e6*Math.random()|0),xd=0;function pd(n,e,t,r,s){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=s,this.key=++xd,this.fa=this.ia=!1}function jr(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function io(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function gd(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function Bc(n){const e={};for(const t in n)e[t]=n[t];return e}const f0="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _c(n,e){let t,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(t in r)n[t]=r[t];for(let i=0;i<f0.length;i++)t=f0[i],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Kr(n){this.src=n,this.g={},this.h=0}Kr.prototype.add=function(n,e,t,r,s){var i=n.toString();n=this.g[i],n||(n=this.g[i]=[],this.h++);var o=ki(n,e,r,s);return-1<o?(e=n[o],t||(e.ia=!1)):(e=new pd(e,this.src,i,!!r,s),e.ia=t,n.push(e)),e};function Ii(n,e){var t=e.type;if(t in n.g){var r=n.g[t],s=Cc(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(jr(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function ki(n,e,t,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.fa&&i.listener==e&&i.capture==!!t&&i.la==r)return s}return-1}var oo="closure_lm_"+(1e6*Math.random()|0),fi={};function Fc(n,e,t,r,s){if(r&&r.once)return Sc(n,e,t,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Fc(n,e[i],t,r,s);return null}return t=uo(t),n&&n[qn]?n.O(e,t,$n(r)?!!r.capture:!!r,s):bc(n,e,t,!1,r,s)}function bc(n,e,t,r,s,i){if(!e)throw Error("Invalid event type");var o=$n(s)?!!s.capture:!!s,a=co(n);if(a||(n[oo]=a=new Kr(n)),t=a.add(e,t,r,o,i),t.proxy)return t;if(r=md(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)cd||(s=o),s===void 0&&(s=!1),n.addEventListener(e.toString(),r,s);else if(n.attachEvent)n.attachEvent(Ic(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function md(){function n(t){return e.call(n.src,n.listener,t)}const e=vd;return n}function Sc(n,e,t,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Sc(n,e[i],t,r,s);return null}return t=uo(t),n&&n[qn]?n.P(e,t,$n(r)?!!r.capture:!!r,s):bc(n,e,t,!0,r,s)}function Tc(n,e,t,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)Tc(n,e[i],t,r,s);else r=$n(r)?!!r.capture:!!r,t=uo(t),n&&n[qn]?(n=n.i,e=String(e).toString(),e in n.g&&(i=n.g[e],t=ki(i,t,r,s),-1<t&&(jr(i[t]),Array.prototype.splice.call(i,t,1),i.length==0&&(delete n.g[e],n.h--)))):n&&(n=co(n))&&(e=n.g[e.toString()],n=-1,e&&(n=ki(e,t,r,s)),(t=-1<n?e[n]:null)&&ao(t))}function ao(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[qn])Ii(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(Ic(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=co(e))?(Ii(t,n),t.h==0&&(t.src=null,e[oo]=null)):jr(n)}}}function Ic(n){return n in fi?fi[n]:fi[n]="on"+n}function vd(n,e){if(n.fa)n=!0;else{e=new bn(e,this);var t=n.listener,r=n.la||n.src;n.ia&&ao(n),n=t.call(r,e)}return n}function co(n){return n=n[oo],n instanceof Kr?n:null}var di="__closure_events_fn_"+(1e9*Math.random()>>>0);function uo(n){return typeof n=="function"?n:(n[di]||(n[di]=function(e){return n.handleEvent(e)}),n[di])}function me(){xt.call(this),this.i=new Kr(this),this.S=this,this.J=null}ye(me,xt);me.prototype[qn]=!0;me.prototype.removeEventListener=function(n,e,t,r){Tc(this,n,e,t,r)};function we(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new be(e,n);else if(e instanceof be)e.target=e.target||n;else{var s=e;e=new be(r,n),_c(e,s)}if(s=!0,t)for(var i=t.length-1;0<=i;i--){var o=e.g=t[i];s=cr(o,r,!0,e)&&s}if(o=e.g=n,s=cr(o,r,!0,e)&&s,s=cr(o,r,!1,e)&&s,t)for(i=0;i<t.length;i++)o=e.g=t[i],s=cr(o,r,!1,e)&&s}me.prototype.N=function(){if(me.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)jr(t[r]);delete n.g[e],n.h--}}this.J=null};me.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};me.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function cr(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==t){var a=o.listener,u=o.la||o.src;o.ia&&Ii(n.i,o),s=a.call(u,r)!==!1&&s}}return s&&!r.defaultPrevented}var ho=H.JSON.stringify;class yd{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function Ed(){var n=lo;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class Cd{constructor(){this.h=this.g=null}add(e,t){const r=kc.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var kc=new yd(()=>new wd,n=>n.reset());class wd{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Ad(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Dd(n){H.setTimeout(()=>{throw n},0)}let Sn,Tn=!1,lo=new Cd,Nc=()=>{const n=H.Promise.resolve(void 0);Sn=()=>{n.then(Bd)}};var Bd=()=>{for(var n;n=Ed();){try{n.h.call(n.g)}catch(t){Dd(t)}var e=kc;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Tn=!1};function Gr(n,e){me.call(this),this.h=n||1,this.g=e||H,this.j=Fe(this.qb,this),this.l=Date.now()}ye(Gr,me);O=Gr.prototype;O.ga=!1;O.T=null;O.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),we(this,"tick"),this.ga&&(fo(this),this.start()))}};O.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function fo(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}O.N=function(){Gr.$.N.call(this),fo(this),delete this.g};function xo(n,e,t){if(typeof n=="function")t&&(n=Fe(n,t));else if(n&&typeof n.handleEvent=="function")n=Fe(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:H.setTimeout(n,e||0)}function Rc(n){n.g=xo(()=>{n.g=null,n.i&&(n.i=!1,Rc(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class _d extends xt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Rc(this)}N(){super.N(),this.g&&(H.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function In(n){xt.call(this),this.h=n,this.g={}}ye(In,xt);var d0=[];function Lc(n,e,t,r){Array.isArray(t)||(t&&(d0[0]=t.toString()),t=d0);for(var s=0;s<t.length;s++){var i=Fc(e,t[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function Oc(n){io(n.g,function(e,t){this.g.hasOwnProperty(t)&&ao(e)},n),n.g={}}In.prototype.N=function(){In.$.N.call(this),Oc(this)};In.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Wr(){this.g=!0}Wr.prototype.Ea=function(){this.g=!1};function Fd(n,e,t,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",a=i.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var d=h.split("_");o=2<=d.length&&d[1]=="type"?o+(h+"="+c+"&"):o+(h+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+t+`
`+o})}function bd(n,e,t,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+t+`
`+i+" "+o})}function Vt(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+Td(n,t)+(r?" "+r:"")})}function Sd(n,e){n.info(function(){return"TIMEOUT: "+e})}Wr.prototype.info=function(){};function Td(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return ho(t)}catch{return e}}var Tt={},x0=null;function Qr(){return x0=x0||new me}Tt.Ta="serverreachability";function Pc(n){be.call(this,Tt.Ta,n)}ye(Pc,be);function kn(n){const e=Qr();we(e,new Pc(e))}Tt.STAT_EVENT="statevent";function Mc(n,e){be.call(this,Tt.STAT_EVENT,n),this.stat=e}ye(Mc,be);function Ie(n){const e=Qr();we(e,new Mc(e,n))}Tt.Ua="timingevent";function Vc(n,e){be.call(this,Tt.Ua,n),this.size=e}ye(Vc,be);function Hn(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return H.setTimeout(function(){n()},e)}var Xr={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Uc={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function po(){}po.prototype.h=null;function p0(n){return n.h||(n.h=n.i())}function $c(){}var zn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function go(){be.call(this,"d")}ye(go,be);function mo(){be.call(this,"c")}ye(mo,be);var Ni;function Yr(){}ye(Yr,po);Yr.prototype.g=function(){return new XMLHttpRequest};Yr.prototype.i=function(){return{}};Ni=new Yr;function jn(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new In(this),this.P=Id,n=bi?125:void 0,this.V=new Gr(n),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new qc}function qc(){this.i=null,this.g="",this.h=!1}var Id=45e3,Ri={},Fr={};O=jn.prototype;O.setTimeout=function(n){this.P=n};function Li(n,e,t){n.L=1,n.v=Jr(Je(e)),n.s=t,n.S=!0,Hc(n,null)}function Hc(n,e){n.G=Date.now(),Kn(n),n.A=Je(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),Yc(t.i,"t",r),n.C=0,t=n.l.J,n.h=new qc,n.g=vu(n.l,t?e:null,!n.s),0<n.O&&(n.M=new _d(Fe(n.Pa,n,n.g),n.O)),Lc(n.U,n.g,"readystatechange",n.nb),e=n.I?Bc(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),kn(),Fd(n.j,n.u,n.A,n.m,n.W,n.s)}O.nb=function(n){n=n.target;const e=this.M;e&&Ge(n)==3?e.l():this.Pa(n)};O.Pa=function(n){try{if(n==this.g)e:{const h=Ge(this.g);var e=this.g.Ia();const d=this.g.da();if(!(3>h)&&(h!=3||bi||this.g&&(this.h.h||this.g.ja()||y0(this.g)))){this.J||h!=4||e==7||(e==8||0>=d?kn(3):kn(2)),Zr(this);var t=this.g.da();this.ca=t;t:if(zc(this)){var r=y0(this.g);n="";var s=r.length,i=Ge(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yt(this),Cn(this);var o="";break t}this.h.i=new H.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,bd(this.j,this.u,this.A,this.m,this.W,h,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Fn(a)){var c=a;break t}}c=null}if(t=c)Vt(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oi(this,t);else{this.i=!1,this.o=3,Ie(12),yt(this),Cn(this);break e}}this.S?(jc(this,h,o),bi&&this.i&&h==3&&(Lc(this.U,this.V,"tick",this.mb),this.V.start())):(Vt(this.j,this.m,o,null),Oi(this,o)),h==4&&yt(this),this.i&&!this.J&&(h==4?xu(this.l,this):(this.i=!1,Kn(this)))}else Zd(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.o=3,Ie(12)):(this.o=0,Ie(13)),yt(this),Cn(this)}}}catch{}finally{}};function zc(n){return n.g?n.u=="GET"&&n.L!=2&&n.l.Ha:!1}function jc(n,e,t){let r=!0,s;for(;!n.J&&n.C<t.length;)if(s=kd(n,t),s==Fr){e==4&&(n.o=4,Ie(14),r=!1),Vt(n.j,n.m,null,"[Incomplete Response]");break}else if(s==Ri){n.o=4,Ie(15),Vt(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else Vt(n.j,n.m,s,null),Oi(n,s);zc(n)&&s!=Fr&&s!=Ri&&(n.h.g="",n.C=0),e!=4||t.length!=0||n.h.h||(n.o=1,Ie(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Ao(e),e.M=!0,Ie(11))):(Vt(n.j,n.m,t,"[Invalid Chunked Response]"),yt(n),Cn(n))}O.mb=function(){if(this.g){var n=Ge(this.g),e=this.g.ja();this.C<e.length&&(Zr(this),jc(this,n,e),this.i&&n!=4&&Kn(this))}};function kd(n,e){var t=n.C,r=e.indexOf(`
`,t);return r==-1?Fr:(t=Number(e.substring(t,r)),isNaN(t)?Ri:(r+=1,r+t>e.length?Fr:(e=e.slice(r,r+t),n.C=r+t,e)))}O.cancel=function(){this.J=!0,yt(this)};function Kn(n){n.Y=Date.now()+n.P,Kc(n,n.P)}function Kc(n,e){if(n.B!=null)throw Error("WatchDog timer not null");n.B=Hn(Fe(n.lb,n),e)}function Zr(n){n.B&&(H.clearTimeout(n.B),n.B=null)}O.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(Sd(this.j,this.A),this.L!=2&&(kn(),Ie(17)),yt(this),this.o=2,Cn(this)):Kc(this,this.Y-n)};function Cn(n){n.l.H==0||n.J||xu(n.l,n)}function yt(n){Zr(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,fo(n.V),Oc(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Oi(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||Pi(t.i,n))){if(!n.K&&Pi(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)Tr(t),ns(t);else break e;wo(t),Ie(18)}}else t.Fa=s[1],0<t.Fa-t.V&&37500>s[2]&&t.G&&t.A==0&&!t.v&&(t.v=Hn(Fe(t.ib,t),6e3));if(1>=eu(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Et(t,11)}else if((n.K||t.g==n)&&Tr(t),!Fn(e))for(s=t.Ja.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(t.V=c[0],c=c[1],t.H==2)if(c[0]=="c"){t.K=c[1],t.pa=c[2];const h=c[3];h!=null&&(t.ra=h,t.l.info("VER="+t.ra));const d=c[4];d!=null&&(t.Ga=d,t.l.info("SVER="+t.Ga));const l=c[5];l!=null&&typeof l=="number"&&0<l&&(r=1.5*l,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const f=n.g;if(f){const x=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(x){var i=r.i;i.g||x.indexOf("spdy")==-1&&x.indexOf("quic")==-1&&x.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(vo(i,i.h),i.h=null))}if(r.F){const v=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,oe(r.I,r.F,v))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var o=n;if(r.wa=mu(r,r.J?r.pa:null,r.Y),o.K){tu(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.B&&(Zr(a),Kn(a)),r.g=o}else fu(r);0<t.j.length&&rs(t)}else c[0]!="stop"&&c[0]!="close"||Et(t,7);else t.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Et(t,7):Co(t):c[0]!="noop"&&t.h&&t.h.Aa(c),t.A=0)}}kn(4)}catch{}}function Nd(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Hr(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function Rd(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Hr(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function Gc(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(Hr(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=Rd(n),r=Nd(n),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],t&&t[i],n)}var Wc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ld(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),s=null;if(0<=r){var i=n[t].substring(0,r);s=n[t].substring(r+1)}else i=n[t];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function wt(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof wt){this.h=n.h,br(this,n.j),this.s=n.s,this.g=n.g,Sr(this,n.m),this.l=n.l;var e=n.i,t=new Nn;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),g0(this,t),this.o=n.o}else n&&(e=String(n).match(Wc))?(this.h=!1,br(this,e[1]||"",!0),this.s=mn(e[2]||""),this.g=mn(e[3]||"",!0),Sr(this,e[4]),this.l=mn(e[5]||"",!0),g0(this,e[6]||"",!0),this.o=mn(e[7]||"")):(this.h=!1,this.i=new Nn(null,this.h))}wt.prototype.toString=function(){var n=[],e=this.j;e&&n.push(vn(e,m0,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(vn(e,m0,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(vn(t,t.charAt(0)=="/"?Md:Pd,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",vn(t,Ud)),n.join("")};function Je(n){return new wt(n)}function br(n,e,t){n.j=t?mn(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Sr(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function g0(n,e,t){e instanceof Nn?(n.i=e,$d(n.i,n.h)):(t||(e=vn(e,Vd)),n.i=new Nn(e,n.h))}function oe(n,e,t){n.i.set(e,t)}function Jr(n){return oe(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function mn(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function vn(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,Od),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Od(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var m0=/[#\/\?@]/g,Pd=/[#\?:]/g,Md=/[#\?]/g,Vd=/[#\?@]/g,Ud=/#/g;function Nn(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function pt(n){n.g||(n.g=new Map,n.h=0,n.i&&Ld(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}O=Nn.prototype;O.add=function(n,e){pt(this),this.i=null,n=tn(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function Qc(n,e){pt(n),e=tn(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Xc(n,e){return pt(n),e=tn(n,e),n.g.has(e)}O.forEach=function(n,e){pt(this),this.g.forEach(function(t,r){t.forEach(function(s){n.call(e,s,r,this)},this)},this)};O.ta=function(){pt(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const s=n[r];for(let i=0;i<s.length;i++)t.push(e[r])}return t};O.Z=function(n){pt(this);let e=[];if(typeof n=="string")Xc(this,n)&&(e=e.concat(this.g.get(tn(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};O.set=function(n,e){return pt(this),this.i=null,n=tn(this,n),Xc(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};O.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function Yc(n,e,t){Qc(n,e),0<t.length&&(n.i=null,n.g.set(tn(n,e),ro(t)),n.h+=t.length)}O.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};function tn(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function $d(n,e){e&&!n.j&&(pt(n),n.i=null,n.g.forEach(function(t,r){var s=r.toLowerCase();r!=s&&(Qc(this,r),Yc(this,s,t))},n)),n.j=e}var qd=class{constructor(n,e){this.g=n,this.map=e}};function Zc(n){this.l=n||Hd,H.PerformanceNavigationTiming?(n=H.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(H.g&&H.g.Ka&&H.g.Ka()&&H.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Hd=10;function Jc(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function eu(n){return n.h?1:n.g?n.g.size:0}function Pi(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function vo(n,e){n.g?n.g.add(e):n.h=e}function tu(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}Zc.prototype.cancel=function(){if(this.i=nu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function nu(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return ro(n.i)}var zd=class{stringify(n){return H.JSON.stringify(n,void 0)}parse(n){return H.JSON.parse(n,void 0)}};function jd(){this.g=new zd}function Kd(n,e,t){const r=t||"";try{Gc(n,function(s,i){let o=s;$n(s)&&(o=ho(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Gd(n,e){const t=new Wr;if(H.Image){const r=new Image;r.onload=ar(ur,t,r,"TestLoadImage: loaded",!0,e),r.onerror=ar(ur,t,r,"TestLoadImage: error",!1,e),r.onabort=ar(ur,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=ar(ur,t,r,"TestLoadImage: timeout",!1,e),H.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function ur(n,e,t,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Gn(n){this.l=n.fc||null,this.j=n.ob||!1}ye(Gn,po);Gn.prototype.g=function(){return new es(this.l,this.j)};Gn.prototype.i=function(n){return function(){return n}}({});function es(n,e){me.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=yo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ye(es,me);var yo=0;O=es.prototype;O.open=function(n,e){if(this.readyState!=yo)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Rn(this)};O.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||H).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};O.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wn(this)),this.readyState=yo};O.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Rn(this)),this.g&&(this.readyState=3,Rn(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof H.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ru(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function ru(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}O.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Wn(this):Rn(this),this.readyState==3&&ru(this)}};O.Za=function(n){this.g&&(this.response=this.responseText=n,Wn(this))};O.Ya=function(n){this.g&&(this.response=n,Wn(this))};O.ka=function(){this.g&&Wn(this)};function Wn(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Rn(n)}O.setRequestHeader=function(n,e){this.v.append(n,e)};O.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};O.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function Rn(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var Wd=H.JSON.parse;function le(n){me.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=su,this.L=this.M=!1}ye(le,me);var su="",Qd=/^https?$/i,Xd=["POST","PUT"];O=le.prototype;O.Oa=function(n){this.M=n};O.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ni.g(),this.C=this.u?p0(this.u):p0(Ni),this.g.onreadystatechange=Fe(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(i){v0(this,i);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)t.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())t.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(i=>i.toLowerCase()=="content-type"),s=H.FormData&&n instanceof H.FormData,!(0<=Cc(Xd,e))||r||s||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of t)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{au(this),0<this.B&&((this.L=Yd(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Fe(this.ua,this)):this.A=xo(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){v0(this,i)}};function Yd(n){return Kt&&typeof n.timeout=="number"&&n.ontimeout!==void 0}O.ua=function(){typeof no<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,we(this,"timeout"),this.abort(8))};function v0(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,iu(n),ts(n)}function iu(n){n.F||(n.F=!0,we(n,"complete"),we(n,"error"))}O.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,we(this,"complete"),we(this,"abort"),ts(this))};O.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ts(this,!0)),le.$.N.call(this)};O.La=function(){this.s||(this.G||this.v||this.l?ou(this):this.kb())};O.kb=function(){ou(this)};function ou(n){if(n.h&&typeof no<"u"&&(!n.C[1]||Ge(n)!=4||n.da()!=2)){if(n.v&&Ge(n)==4)xo(n.La,0,n);else if(we(n,"readystatechange"),Ge(n)==4){n.h=!1;try{const o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=o===0){var s=String(n.I).match(Wc)[1]||null;!s&&H.self&&H.self.location&&(s=H.self.location.protocol.slice(0,-1)),r=!Qd.test(s?s.toLowerCase():"")}t=r}if(t)we(n,"complete"),we(n,"success");else{n.m=6;try{var i=2<Ge(n)?n.g.statusText:""}catch{i=""}n.j=i+" ["+n.da()+"]",iu(n)}}finally{ts(n)}}}}function ts(n,e){if(n.g){au(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||we(n,"ready");try{t.onreadystatechange=r}catch{}}}function au(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(H.clearTimeout(n.A),n.A=null)}O.isActive=function(){return!!this.g};function Ge(n){return n.g?n.g.readyState:0}O.da=function(){try{return 2<Ge(this)?this.g.status:-1}catch{return-1}};O.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};O.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),Wd(e)}};function y0(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case su:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Zd(n){const e={};n=(n.g&&2<=Ge(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(Fn(n[r]))continue;var t=Ad(n[r]);const s=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const i=e[s]||[];e[s]=i,i.push(t)}gd(e,function(r){return r.join(", ")})}O.Ia=function(){return this.m};O.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function cu(n){let e="";return io(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function Eo(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=cu(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):oe(n,e,t))}function pn(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function uu(n){this.Ga=0,this.j=[],this.l=new Wr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=pn("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=pn("baseRetryDelayMs",5e3,n),this.hb=pn("retryDelaySeedMs",1e4,n),this.eb=pn("forwardChannelMaxRetries",2,n),this.xa=pn("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Zc(n&&n.concurrentRequestLimit),this.Ja=new jd,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}O=uu.prototype;O.ra=8;O.H=1;function Co(n){if(hu(n),n.H==3){var e=n.W++,t=Je(n.I);if(oe(t,"SID",n.K),oe(t,"RID",e),oe(t,"TYPE","terminate"),Qn(n,t),e=new jn(n,n.l,e),e.L=2,e.v=Jr(Je(t)),t=!1,H.navigator&&H.navigator.sendBeacon)try{t=H.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&H.Image&&(new Image().src=e.v,t=!0),t||(e.g=vu(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Kn(e)}gu(n)}function ns(n){n.g&&(Ao(n),n.g.cancel(),n.g=null)}function hu(n){ns(n),n.u&&(H.clearTimeout(n.u),n.u=null),Tr(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&H.clearTimeout(n.m),n.m=null)}function rs(n){if(!Jc(n.i)&&!n.m){n.m=!0;var e=n.Na;Sn||Nc(),Tn||(Sn(),Tn=!0),lo.add(e,n),n.C=0}}function Jd(n,e){return eu(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=Hn(Fe(n.Na,n,e),pu(n,n.C)),n.C++,!0)}O.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const s=new jn(this,this.l,n);let i=this.s;if(this.U&&(i?(i=Bc(i),_c(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=lu(this,s,e),t=Je(this.I),oe(t,"RID",n),oe(t,"CVER",22),this.F&&oe(t,"X-HTTP-Session-Id",this.F),Qn(this,t),i&&(this.O?e="headers="+encodeURIComponent(String(cu(i)))+"&"+e:this.o&&Eo(t,this.o,i)),vo(this.i,s),this.bb&&oe(t,"TYPE","init"),this.P?(oe(t,"$req",e),oe(t,"SID","null"),s.aa=!0,Li(s,t,null)):Li(s,t,e),this.H=2}}else this.H==3&&(n?E0(this,n):this.j.length==0||Jc(this.i)||E0(this))};function E0(n,e){var t;e?t=e.m:t=n.W++;const r=Je(n.I);oe(r,"SID",n.K),oe(r,"RID",t),oe(r,"AID",n.V),Qn(n,r),n.o&&n.s&&Eo(r,n.o,n.s),t=new jn(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=lu(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),vo(n.i,t),Li(t,r,e)}function Qn(n,e){n.na&&io(n.na,function(t,r){oe(e,r,t)}),n.h&&Gc({},function(t,r){oe(e,r,t)})}function lu(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Fe(n.h.Va,n.h,n):null;e:{var s=n.j;let i=-1;for(;;){const o=["count="+t];i==-1?0<t?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let u=0;u<t;u++){let c=s[u].g;const h=s[u].map;if(c-=i,0>c)i=Math.max(0,s[u].g-100),a=!1;else try{Kd(h,o,"req"+c+"_")}catch{r&&r(h)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function fu(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Sn||Nc(),Tn||(Sn(),Tn=!0),lo.add(e,n),n.A=0}}function wo(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=Hn(Fe(n.Ma,n),pu(n,n.A)),n.A++,!0)}O.Ma=function(){if(this.u=null,du(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Hn(Fe(this.jb,this),n)}};O.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ie(10),ns(this),du(this))};function Ao(n){n.B!=null&&(H.clearTimeout(n.B),n.B=null)}function du(n){n.g=new jn(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=Je(n.wa);oe(e,"RID","rpc"),oe(e,"SID",n.K),oe(e,"AID",n.V),oe(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&oe(e,"TO",n.qa),oe(e,"TYPE","xmlhttp"),Qn(n,e),n.o&&n.s&&Eo(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=Jr(Je(e)),t.s=null,t.S=!0,Hc(t,n)}O.ib=function(){this.v!=null&&(this.v=null,ns(this),wo(this),Ie(19))};function Tr(n){n.v!=null&&(H.clearTimeout(n.v),n.v=null)}function xu(n,e){var t=null;if(n.g==e){Tr(n),Ao(n),n.g=null;var r=2}else if(Pi(n.i,e))t=e.F,tu(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.s?e.s.length:0,e=Date.now()-e.G;var s=n.C;r=Qr(),we(r,new Vc(r,t)),rs(n)}else fu(n);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&Jd(n,e)||r==2&&wo(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),s){case 1:Et(n,5);break;case 4:Et(n,10);break;case 3:Et(n,6);break;default:Et(n,2)}}}function pu(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Et(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Fe(n.pb,n);t||(t=new wt("//www.google.com/images/cleardot.gif"),H.location&&H.location.protocol=="http"||br(t,"https"),Jr(t)),Gd(t.toString(),r)}else Ie(2);n.H=0,n.h&&n.h.za(e),gu(n),hu(n)}O.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Ie(2)):(this.l.info("Failed to ping google.com"),Ie(1))};function gu(n){if(n.H=0,n.ma=[],n.h){const e=nu(n.i);(e.length!=0||n.j.length!=0)&&(h0(n.ma,e),h0(n.ma,n.j),n.i.i.length=0,ro(n.j),n.j.length=0),n.h.ya()}}function mu(n,e,t){var r=t instanceof wt?Je(t):new wt(t);if(r.g!="")e&&(r.g=e+"."+r.g),Sr(r,r.m);else{var s=H.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new wt(null);r&&br(i,r),e&&(i.g=e),s&&Sr(i,s),t&&(i.l=t),r=i}return t=n.F,e=n.Da,t&&e&&oe(r,t,e),oe(r,"VER",n.ra),Qn(n,r),r}function vu(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t&&n.Ha&&!n.va?new le(new Gn({ob:!0})):new le(n.va),e.Oa(n.J),e}O.isActive=function(){return!!this.h&&this.h.isActive(this)};function yu(){}O=yu.prototype;O.Ba=function(){};O.Aa=function(){};O.za=function(){};O.ya=function(){};O.isActive=function(){return!0};O.Va=function(){};function Ir(){if(Kt&&!(10<=Number(fd)))throw Error("Environmental error: no available transport.")}Ir.prototype.g=function(n,e){return new Me(n,e)};function Me(n,e){me.call(this),this.g=new uu(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Fn(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Fn(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new nn(this)}ye(Me,me);Me.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Ie(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=mu(n,null,n.Y),rs(n)};Me.prototype.close=function(){Co(this.g)};Me.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=ho(n),n=t);e.j.push(new qd(e.fb++,n)),e.H==3&&rs(e)};Me.prototype.N=function(){this.g.h=null,delete this.j,Co(this.g),delete this.g,Me.$.N.call(this)};function Eu(n){go.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}ye(Eu,go);function Cu(){mo.call(this),this.status=1}ye(Cu,mo);function nn(n){this.g=n}ye(nn,yu);nn.prototype.Ba=function(){we(this.g,"a")};nn.prototype.Aa=function(n){we(this.g,new Eu(n))};nn.prototype.za=function(n){we(this.g,new Cu)};nn.prototype.ya=function(){we(this.g,"b")};function ex(){this.blockSize=-1}function ze(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ye(ze,ex);ze.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function xi(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(s=0;16>s;++s)r[s]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],s=n.g[2];var i=n.g[3],o=e+(i^t&(s^i))+r[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[3]+3250441966&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(i^t&(s^i))+r[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[7]+4249261313&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(i^t&(s^i))+r[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[11]+2304563134&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(i^t&(s^i))+r[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=i+(s^e&(t^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(t^i&(e^t))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=t+(e^s&(i^e))+r[15]+1236535329&4294967295,t=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(t^s))+r[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[0]+3921069994&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(t^s))+r[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[4]+3889429448&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(t^s))+r[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[8]+1163531501&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(t^s))+r[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=i+(t^s&(e^t))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^t&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=t+(i^e&(s^i))+r[12]+2368359562&4294967295,t=s+(o<<20&4294967295|o>>>12),o=e+(t^s^i)+r[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[14]+4259657740&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(t^s^i)+r[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[10]+3200236656&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(t^s^i)+r[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[6]+76029189&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(t^s^i)+r[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=i+(e^t^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^t)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=t+(s^i^e)+r[2]+3299628645&4294967295,t=s+(o<<23&4294967295|o>>>9),o=e+(s^(t|~i))+r[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[5]+4237533241&4294967295,t=s+(o<<21&4294967295|o>>>11),o=e+(s^(t|~i))+r[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[1]+2240044497&4294967295,t=s+(o<<21&4294967295|o>>>11),o=e+(s^(t|~i))+r[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[13]+1309151649&4294967295,t=s+(o<<21&4294967295|o>>>11),o=e+(s^(t|~i))+r[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=i+(t^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~t))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=t+(i^(s|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+s&4294967295,n.g[3]=n.g[3]+i&4294967295}ze.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=t;)xi(this,n,i),i+=this.blockSize;if(typeof n=="string"){for(;i<e;)if(r[s++]=n.charCodeAt(i++),s==this.blockSize){xi(this,r),s=0;break}}else for(;i<e;)if(r[s++]=n[i++],s==this.blockSize){xi(this,r),s=0;break}}this.h=s,this.i+=e};ze.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function te(n,e){this.h=e;for(var t=[],r=!0,s=n.length-1;0<=s;s--){var i=n[s]|0;r&&i==e||(t[s]=i,r=!1)}this.g=t}var tx={};function Do(n){return-128<=n&&128>n?ud(n,function(e){return new te([e|0],0>e?-1:0)}):new te([n|0],0>n?-1:0)}function We(n){if(isNaN(n)||!isFinite(n))return $t;if(0>n)return Ce(We(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Mi;return new te(e,0)}function wu(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return Ce(wu(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=We(Math.pow(e,8)),r=$t,s=0;s<n.length;s+=8){var i=Math.min(8,n.length-s),o=parseInt(n.substring(s,s+i),e);8>i?(i=We(Math.pow(e,i)),r=r.R(i).add(We(o))):(r=r.R(t),r=r.add(We(o)))}return r}var Mi=4294967296,$t=Do(0),Vi=Do(1),C0=Do(16777216);O=te.prototype;O.ea=function(){if(Ue(this))return-Ce(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Mi+r)*e,e*=Mi}return n};O.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(Ye(this))return"0";if(Ue(this))return"-"+Ce(this).toString(n);for(var e=We(Math.pow(n,6)),t=this,r="";;){var s=Nr(t,e).g;t=kr(t,s.R(e));var i=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=s,Ye(t))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};O.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function Ye(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function Ue(n){return n.h==-1}O.X=function(n){return n=kr(this,n),Ue(n)?-1:Ye(n)?0:1};function Ce(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new te(t,~n.h).add(Vi)}O.abs=function(){return Ue(this)?Ce(this):this};O.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(n.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(n.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,t[s]=o<<16|i}return new te(t,t[t.length-1]&-2147483648?-1:0)};function kr(n,e){return n.add(Ce(e))}O.R=function(n){if(Ye(this)||Ye(n))return $t;if(Ue(this))return Ue(n)?Ce(this).R(Ce(n)):Ce(Ce(this).R(n));if(Ue(n))return Ce(this.R(Ce(n)));if(0>this.X(C0)&&0>n.X(C0))return We(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<n.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=n.D(s)>>>16,u=n.D(s)&65535;t[2*r+2*s]+=o*u,hr(t,2*r+2*s),t[2*r+2*s+1]+=i*u,hr(t,2*r+2*s+1),t[2*r+2*s+1]+=o*a,hr(t,2*r+2*s+1),t[2*r+2*s+2]+=i*a,hr(t,2*r+2*s+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new te(t,0)};function hr(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function gn(n,e){this.g=n,this.h=e}function Nr(n,e){if(Ye(e))throw Error("division by zero");if(Ye(n))return new gn($t,$t);if(Ue(n))return e=Nr(Ce(n),e),new gn(Ce(e.g),Ce(e.h));if(Ue(e))return e=Nr(n,Ce(e)),new gn(Ce(e.g),e.h);if(30<n.g.length){if(Ue(n)||Ue(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Vi,r=e;0>=r.X(n);)t=w0(t),r=w0(r);var s=Ot(t,1),i=Ot(r,1);for(r=Ot(r,2),t=Ot(t,2);!Ye(r);){var o=i.add(r);0>=o.X(n)&&(s=s.add(t),i=o),r=Ot(r,1),t=Ot(t,1)}return e=kr(n,s.R(e)),new gn(s,e)}for(s=$t;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=We(t),o=i.R(e);Ue(o)||0<o.X(n);)t-=r,i=We(t),o=i.R(e);Ye(i)&&(i=Vi),s=s.add(i),n=kr(n,o)}return new gn(s,n)}O.gb=function(n){return Nr(this,n).h};O.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new te(t,this.h&n.h)};O.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new te(t,this.h|n.h)};O.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new te(t,this.h^n.h)};function w0(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new te(t,n.h)}function Ot(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,s=[],i=0;i<r;i++)s[i]=0<e?n.D(i+t)>>>e|n.D(i+t+1)<<32-e:n.D(i+t);return new te(s,n.h)}Ir.prototype.createWebChannel=Ir.prototype.g;Me.prototype.send=Me.prototype.u;Me.prototype.open=Me.prototype.m;Me.prototype.close=Me.prototype.close;Xr.NO_ERROR=0;Xr.TIMEOUT=8;Xr.HTTP_ERROR=6;Uc.COMPLETE="complete";$c.EventType=zn;zn.OPEN="a";zn.CLOSE="b";zn.ERROR="c";zn.MESSAGE="d";me.prototype.listen=me.prototype.O;le.prototype.listenOnce=le.prototype.P;le.prototype.getLastError=le.prototype.Sa;le.prototype.getLastErrorCode=le.prototype.Ia;le.prototype.getStatus=le.prototype.da;le.prototype.getResponseJson=le.prototype.Wa;le.prototype.getResponseText=le.prototype.ja;le.prototype.send=le.prototype.ha;le.prototype.setWithCredentials=le.prototype.Oa;ze.prototype.digest=ze.prototype.l;ze.prototype.reset=ze.prototype.reset;ze.prototype.update=ze.prototype.j;te.prototype.add=te.prototype.add;te.prototype.multiply=te.prototype.R;te.prototype.modulo=te.prototype.gb;te.prototype.compare=te.prototype.X;te.prototype.toNumber=te.prototype.ea;te.prototype.toString=te.prototype.toString;te.prototype.getBits=te.prototype.D;te.fromNumber=We;te.fromString=wu;var nx=function(){return new Ir},rx=function(){return Qr()},pi=Xr,sx=Uc,ix=Tt,A0={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ox=Gn,lr=$c,ax=le,cx=ze,qt=te;const D0="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}De.UNAUTHENTICATED=new De(null),De.GOOGLE_CREDENTIALS=new De("google-credentials-uid"),De.FIRST_PARTY=new De("first-party-uid"),De.MOCK_USER=new De("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rn="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt=new pc("@firebase/firestore");function B0(){return Dt.logLevel}function M(n,...e){if(Dt.logLevel<=J.DEBUG){const t=e.map(Bo);Dt.debug(`Firestore (${rn}): ${n}`,...t)}}function et(n,...e){if(Dt.logLevel<=J.ERROR){const t=e.map(Bo);Dt.error(`Firestore (${rn}): ${n}`,...t)}}function Gt(n,...e){if(Dt.logLevel<=J.WARN){const t=e.map(Bo);Dt.warn(`Firestore (${rn}): ${n}`,...t)}}function Bo(n){if(typeof n=="string")return n;try{return e=n,JSON.stringify(e)}catch{return n}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(n="Unexpected state"){const e=`FIRESTORE (${rn}) INTERNAL ASSERTION FAILED: `+n;throw et(e),new Error(e)}function ce(n,e){n||q()}function j(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class P extends en{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ux{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(De.UNAUTHENTICATED))}shutdown(){}}class hx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class lx{constructor(e){this.t=e,this.currentUser=De.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const s=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let i=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ct,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ct)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ce(typeof r.accessToken=="string"),new Au(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ce(e===null||typeof e=="string"),new De(e)}}class fx{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=De.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class dx{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new fx(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(De.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class px{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const r=i=>{i.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.T;return this.T=i.token,M("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.I.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.I.getImmediate({optional:!0});i?s(i):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ce(typeof t.token=="string"),this.T=t.token,new xx(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=gx(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function Z(n,e){return n<e?-1:n>e?1:0}function Wt(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return pe.fromMillis(Date.now())}static fromDate(e){return pe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new pe(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.timestamp=e}static fromTimestamp(e){return new z(e)}static min(){return new z(new pe(0,0))}static max(){return new z(new pe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,t,r){t===void 0?t=0:t>e.length&&q(),r===void 0?r=e.length-t:r>e.length-t&&q(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ln.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ln?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ae extends Ln{construct(e,t,r){return new ae(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new P(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new ae(t)}static emptyPath(){return new ae([])}}const mx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _e extends Ln{construct(e,t,r){return new _e(e,t,r)}static isValidIdentifier(e){return mx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_e.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _e(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new P(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new P(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new P(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new P(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _e(t)}static emptyPath(){return new _e([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.path=e}static fromPath(e){return new U(ae.fromString(e))}static fromName(e){return new U(ae.fromString(e).popFirst(5))}static empty(){return new U(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new ae(e.slice()))}}function vx(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=z.fromTimestamp(r===1e9?new pe(t+1,0):new pe(t,r));return new ht(s,U.empty(),e)}function yx(n){return new ht(n.readTime,n.key,-1)}class ht{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ht(z.min(),U.empty(),-1)}static max(){return new ht(z.max(),U.empty(),-1)}}function Ex(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:Z(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xn(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==Cx)throw n;M("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(s=>s?R.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new R((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const c=u;t(e[c]).next(h=>{o[c]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,t){return new R((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function Yn(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>t.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}_o.ct=-1;function ss(n){return n==null}function Rr(n){return n===0&&1/n==-1/0}function Ax(n){return typeof n=="number"&&Number.isInteger(n)&&!Rr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function It(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Bu(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,t){this.comparator=e,this.root=t||Ee.EMPTY}insert(e,t){return new he(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ee.BLACK,null,null))}remove(e){return new he(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ee.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fr(this.root,e,this.comparator,!1)}getReverseIterator(){return new fr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fr(this.root,e,this.comparator,!0)}}class fr{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ee{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Ee.RED,this.left=s??Ee.EMPTY,this.right=i??Ee.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Ee(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ee.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Ee.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ee.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ee.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();const e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}}Ee.EMPTY=null,Ee.RED=!0,Ee.BLACK=!1;Ee.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(n,e,t,r,s){return this}insert(n,e,t){return new Ee(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.comparator=e,this.data=new he(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new F0(this.data.getIterator())}getIteratorFrom(e){return new F0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Se)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Se(this.comparator);return t.data=e,t}}class F0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.fields=e,e.sort(_e.comparator)}static empty(){return new Oe([])}unionWith(e){let t=new Se(_e.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Oe(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wt(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _u("Invalid base64 string: "+s):s}}(e);return new Te(t)}static fromUint8Array(e){const t=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new Te(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Te.EMPTY_BYTE_STRING=new Te("");const Dx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lt(n){if(ce(!!n),typeof n=="string"){let e=0;const t=Dx.exec(n);if(ce(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:de(n.seconds),nanos:de(n.nanos)}}function de(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Bt(n){return typeof n=="string"?Te.fromBase64String(n):Te.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function bo(n){const e=n.mapValue.fields.__previous_value__;return Fo(e)?bo(e):e}function On(n){const e=lt(n.mapValue.fields.__local_write_time__.timestampValue);return new pe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t,r,s,i,o,a,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class Pn{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Pn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Pn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function _t(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fo(n)?4:_x(n)?9007199254740991:10:q()}function Xe(n,e){if(n===e)return!0;const t=_t(n);if(t!==_t(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return On(n).isEqual(On(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=lt(r.timestampValue),o=lt(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return Bt(r.bytesValue).isEqual(Bt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return de(r.geoPointValue.latitude)===de(s.geoPointValue.latitude)&&de(r.geoPointValue.longitude)===de(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return de(r.integerValue)===de(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=de(r.doubleValue),o=de(s.doubleValue);return i===o?Rr(i)===Rr(o):isNaN(i)&&isNaN(o)}return!1}(n,e);case 9:return Wt(n.arrayValue.values||[],e.arrayValue.values||[],Xe);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(_0(i)!==_0(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Xe(i[a],o[a])))return!1;return!0}(n,e);default:return q()}}function Mn(n,e){return(n.values||[]).find(t=>Xe(t,e))!==void 0}function Qt(n,e){if(n===e)return 0;const t=_t(n),r=_t(e);if(t!==r)return Z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(n.booleanValue,e.booleanValue);case 2:return function(s,i){const o=de(s.integerValue||s.doubleValue),a=de(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return b0(n.timestampValue,e.timestampValue);case 4:return b0(On(n),On(e));case 5:return Z(n.stringValue,e.stringValue);case 6:return function(s,i){const o=Bt(s),a=Bt(i);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let u=0;u<o.length&&u<a.length;u++){const c=Z(o[u],a[u]);if(c!==0)return c}return Z(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,i){const o=Z(de(s.latitude),de(i.latitude));return o!==0?o:Z(de(s.longitude),de(i.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let u=0;u<o.length&&u<a.length;++u){const c=Qt(o[u],a[u]);if(c)return c}return Z(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===dr.mapValue&&i===dr.mapValue)return 0;if(s===dr.mapValue)return 1;if(i===dr.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),u=i.fields||{},c=Object.keys(u);a.sort(),c.sort();for(let h=0;h<a.length&&h<c.length;++h){const d=Z(a[h],c[h]);if(d!==0)return d;const l=Qt(o[a[h]],u[c[h]]);if(l!==0)return l}return Z(a.length,c.length)}(n.mapValue,e.mapValue);default:throw q()}}function b0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Z(n,e);const t=lt(n),r=lt(e),s=Z(t.seconds,r.seconds);return s!==0?s:Z(t.nanos,r.nanos)}function Xt(n){return Ui(n)}function Ui(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=lt(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Bt(n.bytesValue).toBase64():"referenceValue"in n?(t=n.referenceValue,U.fromName(t).toString()):"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Ui(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${Ui(r.fields[a])}`;return i+"}"}(n.mapValue):q();var e,t}function S0(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function $i(n){return!!n&&"integerValue"in n}function So(n){return!!n&&"arrayValue"in n}function T0(n){return!!n&&"nullValue"in n}function I0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Er(n){return!!n&&"mapValue"in n}function wn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return It(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=wn(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wn(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _x(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.value=e}static empty(){return new Ne({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Er(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wn(t)}setAll(e){let t=_e.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=wn(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Er(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xe(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Er(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){It(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ne(wn(this.value))}}function Fu(n){const e=[];return It(n.fields,(t,r)=>{const s=new _e([t]);if(Er(r)){const i=Fu(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Oe(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Be(e,0,z.min(),z.min(),z.min(),Ne.empty(),0)}static newFoundDocument(e,t,r,s){return new Be(e,1,t,z.min(),r,s,0)}static newNoDocument(e,t){return new Be(e,2,t,z.min(),z.min(),Ne.empty(),0)}static newUnknownDocument(e,t){return new Be(e,3,t,z.min(),z.min(),Ne.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ne.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ne.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.position=e,this.inclusive=t}}function k0(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=U.comparator(U.fromName(o.referenceValue),t.key):r=Qt(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function N0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xe(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,t="asc"){this.field=e,this.dir=t}}function Fx(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{}class xe extends bu{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Sx(e,t,r):t==="array-contains"?new kx(e,r):t==="in"?new Nx(e,r):t==="not-in"?new Rx(e,r):t==="array-contains-any"?new Lx(e,r):new xe(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Tx(e,r):new Ix(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Qt(t,this.value)):t!==null&&_t(this.value)===_t(t)&&this.matchesComparison(Qt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class je extends bu{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new je(e,t)}matches(e){return Su(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return e!==null?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Su(n){return n.op==="and"}function Tu(n){return bx(n)&&Su(n)}function bx(n){for(const e of n.filters)if(e instanceof je)return!1;return!0}function qi(n){if(n instanceof xe)return n.field.canonicalString()+n.op.toString()+Xt(n.value);if(Tu(n))return n.filters.map(e=>qi(e)).join(",");{const e=n.filters.map(t=>qi(t)).join(",");return`${n.op}(${e})`}}function Iu(n,e){return n instanceof xe?function(t,r){return r instanceof xe&&t.op===r.op&&t.field.isEqual(r.field)&&Xe(t.value,r.value)}(n,e):n instanceof je?function(t,r){return r instanceof je&&t.op===r.op&&t.filters.length===r.filters.length?t.filters.reduce((s,i,o)=>s&&Iu(i,r.filters[o]),!0):!1}(n,e):void q()}function ku(n){return n instanceof xe?function(e){return`${e.field.canonicalString()} ${e.op} ${Xt(e.value)}`}(n):n instanceof je?function(e){return e.op.toString()+" {"+e.getFilters().map(ku).join(" ,")+"}"}(n):"Filter"}class Sx extends xe{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){const t=U.comparator(e.key,this.key);return this.matchesComparison(t)}}class Tx extends xe{constructor(e,t){super(e,"in",t),this.keys=Nu("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ix extends xe{constructor(e,t){super(e,"not-in",t),this.keys=Nu("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Nu(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>U.fromName(r.referenceValue))}class kx extends xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return So(t)&&Mn(t.arrayValue,this.value)}}class Nx extends xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Mn(this.value.arrayValue,t)}}class Rx extends xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Mn(this.value.arrayValue,t)}}class Lx extends xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!So(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Mn(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.dt=null}}function R0(n,e=null,t=[],r=[],s=null,i=null,o=null){return new Ox(n,e,t,r,s,i,o)}function To(n){const e=j(n);if(e.dt===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>qi(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ss(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Xt(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Xt(r)).join(",")),e.dt=t}return e.dt}function Io(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Fx(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Iu(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!N0(n.startAt,e.startAt)&&N0(n.endAt,e.endAt)}function Hi(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.wt=null,this._t=null,this.startAt,this.endAt}}function Px(n,e,t,r,s,i,o,a){return new sn(n,e,t,r,s,i,o,a)}function Ru(n){return new sn(n)}function L0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ko(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function is(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(t!==null)return t}return null}function Lu(n){return n.collectionGroup!==null}function zt(n){const e=j(n);if(e.wt===null){e.wt=[];const t=is(e),r=ko(e);if(t!==null&&r===null)t.isKeyField()||e.wt.push(new Ht(t)),e.wt.push(new Ht(_e.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Ht(_e.keyField(),i))}}}return e.wt}function tt(n){const e=j(n);if(!e._t)if(e.limitType==="F")e._t=R0(e.path,e.collectionGroup,zt(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of zt(e)){const o=i.dir==="desc"?"asc":"desc";t.push(new Ht(i.field,o))}const r=e.endAt?new Lr(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Lr(e.startAt.position,e.startAt.inclusive):null;e._t=R0(e.path,e.collectionGroup,t,e.filters,e.limit,r,s)}return e._t}function zi(n,e){e.getFirstInequalityField(),is(n);const t=n.filters.concat([e]);return new sn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Or(n,e,t){return new sn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function os(n,e){return Io(tt(n),tt(e))&&n.limitType===e.limitType}function Ou(n){return`${To(tt(n))}|lt:${n.limitType}`}function ji(n){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>ku(r)).join(", ")}]`),ss(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Xt(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Xt(r)).join(",")),`Target(${t})`}(tt(n))}; limitType=${n.limitType})`}function as(n,e){return e.isFoundDocument()&&function(t,r){const s=r.key.path;return t.collectionGroup!==null?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(s):U.isDocumentKey(t.path)?t.path.isEqual(s):t.path.isImmediateParentOf(s)}(n,e)&&function(t,r){for(const s of zt(t))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(t,r){for(const s of t.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(t,r){return!(t.startAt&&!function(s,i,o){const a=k0(s,i,o);return s.inclusive?a<=0:a<0}(t.startAt,zt(t),r)||t.endAt&&!function(s,i,o){const a=k0(s,i,o);return s.inclusive?a>=0:a>0}(t.endAt,zt(t),r))}(n,e)}function Mx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Pu(n){return(e,t)=>{let r=!1;for(const s of zt(n)){const i=Vx(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Vx(n,e,t){const r=n.field.isKeyField()?U.comparator(e.key,t.key):function(s,i,o){const a=i.data.field(s),u=o.data.field(s);return a!==null&&u!==null?Qt(a,u):q()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){It(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Bu(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux=new he(U.comparator);function nt(){return Ux}const Mu=new he(U.comparator);function yn(...n){let e=Mu;for(const t of n)e=e.insert(t.key,t);return e}function Vu(n){let e=Mu;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ct(){return An()}function Uu(){return An()}function An(){return new on(n=>n.toString(),(n,e)=>n.isEqual(e))}const $x=new he(U.comparator),qx=new Se(U.comparator);function Q(...n){let e=qx;for(const t of n)e=e.add(t);return e}const Hx=new Se(Z);function zx(){return Hx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rr(e)?"-0":e}}function qu(n){return{integerValue:""+n}}function jx(n,e){return Ax(e)?qu(e):$u(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(){this._=void 0}}function Kx(n,e,t){return n instanceof Pr?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Fo(s)&&(s=bo(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(t,e):n instanceof Vn?zu(n,e):n instanceof Un?ju(n,e):function(r,s){const i=Hu(r,s),o=O0(i)+O0(r.gt);return $i(i)&&$i(r.gt)?qu(o):$u(r.serializer,o)}(n,e)}function Gx(n,e,t){return n instanceof Vn?zu(n,e):n instanceof Un?ju(n,e):t}function Hu(n,e){return n instanceof Mr?$i(t=e)||function(r){return!!r&&"doubleValue"in r}(t)?e:{integerValue:0}:null;var t}class Pr extends cs{}class Vn extends cs{constructor(e){super(),this.elements=e}}function zu(n,e){const t=Ku(e);for(const r of n.elements)t.some(s=>Xe(s,r))||t.push(r);return{arrayValue:{values:t}}}class Un extends cs{constructor(e){super(),this.elements=e}}function ju(n,e){let t=Ku(e);for(const r of n.elements)t=t.filter(s=>!Xe(s,r));return{arrayValue:{values:t}}}class Mr extends cs{constructor(e,t){super(),this.serializer=e,this.gt=t}}function O0(n){return de(n.integerValue||n.doubleValue)}function Ku(n){return So(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Wx(n,e){return n.field.isEqual(e.field)&&function(t,r){return t instanceof Vn&&r instanceof Vn||t instanceof Un&&r instanceof Un?Wt(t.elements,r.elements,Xe):t instanceof Mr&&r instanceof Mr?Xe(t.gt,r.gt):t instanceof Pr&&r instanceof Pr}(n.transform,e.transform)}class Qx{constructor(e,t){this.version=e,this.transformResults=t}}class He{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new He}static exists(e){return new He(void 0,e)}static updateTime(e){return new He(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cr(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class us{}function Gu(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new No(n.key,He.none()):new Zn(n.key,n.data,He.none());{const t=n.data,r=Ne.empty();let s=new Se(_e.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new gt(n.key,r,new Oe(s.toArray()),He.none())}}function Xx(n,e,t){n instanceof Zn?function(r,s,i){const o=r.value.clone(),a=M0(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,e,t):n instanceof gt?function(r,s,i){if(!Cr(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=M0(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Wu(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(n,e,t):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,t)}function Dn(n,e,t,r){return n instanceof Zn?function(s,i,o,a){if(!Cr(s.precondition,i))return o;const u=s.value.clone(),c=V0(s.fieldTransforms,a,i);return u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof gt?function(s,i,o,a){if(!Cr(s.precondition,i))return o;const u=V0(s.fieldTransforms,a,i),c=i.data;return c.setAll(Wu(s)),c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,i,o){return Cr(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(n,e,t)}function Yx(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Hu(r.transform,s||null);i!=null&&(t===null&&(t=Ne.empty()),t.set(r.field,i))}return t||null}function P0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(t,r){return t===void 0&&r===void 0||!(!t||!r)&&Wt(t,r,(s,i)=>Wx(s,i))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Zn extends us{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class gt extends us{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Wu(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function M0(n,e,t){const r=new Map;ce(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Gx(o,a,t[s]))}return r}function V0(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,Kx(i,o,e))}return r}class No extends us{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zx extends us{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Xx(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Dn(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Dn(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Uu();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const u=Gu(o,a);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Q())}isEqual(e){return this.batchId===e.batchId&&Wt(this.mutations,e.mutations,(t,r)=>P0(t,r))&&Wt(this.baseMutations,e.baseMutations,(t,r)=>P0(t,r))}}class Ro{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ce(e.mutations.length===r.length);let s=$x;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ro(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fe,Y;function np(n){switch(n){default:return q();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function Qu(n){if(n===void 0)return et("GRPC error has no .code"),F.UNKNOWN;switch(n){case fe.OK:return F.OK;case fe.CANCELLED:return F.CANCELLED;case fe.UNKNOWN:return F.UNKNOWN;case fe.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case fe.INTERNAL:return F.INTERNAL;case fe.UNAVAILABLE:return F.UNAVAILABLE;case fe.UNAUTHENTICATED:return F.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case fe.NOT_FOUND:return F.NOT_FOUND;case fe.ALREADY_EXISTS:return F.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return F.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case fe.ABORTED:return F.ABORTED;case fe.OUT_OF_RANGE:return F.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return F.UNIMPLEMENTED;case fe.DATA_LOSS:return F.DATA_LOSS;default:return q()}}(Y=fe||(fe={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return xr}static getOrCreateInstance(){return xr===null&&(xr=new Lo),xr}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let xr=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp=new qt([4294967295,4294967295],0);function U0(n){const e=rp().encode(n),t=new cx;return t.update(e),new Uint8Array(t.digest())}function $0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new qt([t,r],0),new qt([s,i],0)]}class Oo{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new En(`Invalid padding: ${t}`);if(r<0)throw new En(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new En(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new En(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=qt.fromNumber(this.It)}Et(e,t,r){let s=e.add(t.multiply(qt.fromNumber(r)));return s.compare(sp)===1&&(s=new qt([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const t=U0(e),[r,s]=$0(t);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);if(!this.At(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Oo(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const t=U0(e),[r,s]=$0(t);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);this.Rt(o)}}Rt(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class En extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Jn.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new hs(z.min(),s,new he(Z),nt(),Q())}}class Jn{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Jn(r,t,Q(),Q(),Q())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,t,r,s){this.Pt=e,this.removedTargetIds=t,this.key=r,this.bt=s}}class Xu{constructor(e,t){this.targetId=e,this.Vt=t}}class Yu{constructor(e,t,r=Te.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class q0{constructor(){this.St=0,this.Dt=z0(),this.Ct=Te.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Q(),t=Q(),r=Q();return this.Dt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:q()}}),new Jn(this.Ct,this.xt,e,t,r)}Ft(){this.Nt=!1,this.Dt=z0()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class ip{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=nt(),this.zt=H0(),this.Wt=new he(Z)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const r=this.Zt(t);switch(e.state){case 0:this.te(t)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(t);break;case 3:this.te(t)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),r.$t(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((r,s)=>{this.te(s)&&t(s)})}ne(e){var t;const r=e.targetId,s=e.Vt.count,i=this.se(r);if(i){const o=i.target;if(Hi(o))if(s===0){const a=new U(o.path);this.Yt(r,a,Be.newNoDocument(a,z.min()))}else ce(s===1);else{const a=this.ie(r);if(a!==s){const u=this.re(e,a);if(u!==0){this.ee(r);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,c)}(t=Lo.instance)===null||t===void 0||t.notifyOnExistenceFilterMismatch(function(c,h,d){var l,f,x,v,g,E;const p={localCacheCount:h,existenceFilterCount:d.count},m=d.unchangedNames;return m&&(p.bloomFilter={applied:c===0,hashCount:(l=m==null?void 0:m.hashCount)!==null&&l!==void 0?l:0,bitmapLength:(v=(x=(f=m==null?void 0:m.bits)===null||f===void 0?void 0:f.bitmap)===null||x===void 0?void 0:x.length)!==null&&v!==void 0?v:0,padding:(E=(g=m==null?void 0:m.bits)===null||g===void 0?void 0:g.padding)!==null&&E!==void 0?E:0}),p}(u,a,e.Vt))}}}}re(e,t){const{unchangedNames:r,count:s}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=r;let u,c;try{u=Bt(i).toUint8Array()}catch(h){if(h instanceof _u)return Gt("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw h}try{c=new Oo(u,o,a)}catch(h){return Gt(h instanceof En?"BloomFilter error: ":"Applying bloom filter failed: ",h),1}return c.It===0?1:s!==t-this.oe(e.targetId,c)?2:0}oe(e,t){const r=this.Gt.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;t.vt(a)||(this.Yt(e,i,null),s++)}),s}ce(e){const t=new Map;this.Qt.forEach((i,o)=>{const a=this.se(o);if(a){if(i.current&&Hi(a.target)){const u=new U(a.target.path);this.jt.get(u)!==null||this.ae(o,u)||this.Yt(o,u,Be.newNoDocument(u,e))}i.Mt&&(t.set(o,i.Ot()),i.Ft())}});let r=Q();this.zt.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.se(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.jt.forEach((i,o)=>o.setReadTime(e));const s=new hs(e,t,this.Wt,this.jt,r);return this.jt=nt(),this.zt=H0(),this.Wt=new he(Z),s}Jt(e,t){if(!this.te(e))return;const r=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,r),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,r){if(!this.te(e))return;const s=this.Zt(e);this.ae(e,t)?s.Bt(t,1):s.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),r&&(this.jt=this.jt.insert(t,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new q0,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Se(Z),this.zt=this.zt.insert(e,t)),t}te(e){const t=this.se(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new q0),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function H0(){return new he(U.comparator)}function z0(){return new he(U.comparator)}const op=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),ap=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),cp=(()=>({and:"AND",or:"OR"}))();class up{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ki(n,e){return n.useProto3Json||ss(e)?e:{value:e}}function Vr(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zu(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hp(n,e){return Vr(n,e.toTimestamp())}function Qe(n){return ce(!!n),z.fromTimestamp(function(e){const t=lt(e);return new pe(t.seconds,t.nanos)}(n))}function Po(n,e){return function(t){return new ae(["projects",t.projectId,"databases",t.database])}(n).child("documents").child(e).canonicalString()}function Ju(n){const e=ae.fromString(n);return ce(rh(e)),e}function Gi(n,e){return Po(n.databaseId,e.path)}function gi(n,e){const t=Ju(e);if(t.get(1)!==n.databaseId.projectId)throw new P(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(eh(t))}function Wi(n,e){return Po(n.databaseId,e)}function lp(n){const e=Ju(n);return e.length===4?ae.emptyPath():eh(e)}function Qi(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function eh(n){return ce(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function j0(n,e,t){return{name:Gi(n,e),fields:t.value.mapValue.fields}}function fp(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,c){return u.useProto3Json?(ce(c===void 0||typeof c=="string"),Te.fromBase64String(c||"")):(ce(c===void 0||c instanceof Uint8Array),Te.fromUint8Array(c||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=u.code===void 0?F.UNKNOWN:Qu(u.code);return new P(c,u.message||"")}(o);t=new Yu(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=gi(n,r.document.name),i=Qe(r.document.updateTime),o=r.document.createTime?Qe(r.document.createTime):z.min(),a=new Ne({mapValue:{fields:r.document.fields}}),u=Be.newFoundDocument(s,i,o,a),c=r.targetIds||[],h=r.removedTargetIds||[];t=new wr(c,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=gi(n,r.document),i=r.readTime?Qe(r.readTime):z.min(),o=Be.newNoDocument(s,i),a=r.removedTargetIds||[];t=new wr([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=gi(n,r.document),i=r.removedTargetIds||[];t=new wr([],i,s,null)}else{if(!("filter"in e))return q();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new tp(s,i),a=r.targetId;t=new Xu(a,o)}}return t}function dp(n,e){let t;if(e instanceof Zn)t={update:j0(n,e.key,e.value)};else if(e instanceof No)t={delete:Gi(n,e.key)};else if(e instanceof gt)t={update:j0(n,e.key,e.data),updateMask:wp(e.fieldMask)};else{if(!(e instanceof Zx))return q();t={verify:Gi(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Pr)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Vn)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Un)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Mr)return{fieldPath:i.field.canonicalString(),increment:o.gt};throw q()}(0,r))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:hp(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(n,e.precondition)),t}function xp(n,e){return n&&n.length>0?(ce(e!==void 0),n.map(t=>function(r,s){let i=r.updateTime?Qe(r.updateTime):Qe(s);return i.isEqual(z.min())&&(i=Qe(s)),new Qx(i,r.transformResults||[])}(t,e))):[]}function pp(n,e){return{documents:[Wi(n,e.path)]}}function gp(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=Wi(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Wi(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(u.length!==0)return nh(je.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const i=function(u){if(u.length!==0)return u.map(c=>function(h){return{field:Pt(h.field),direction:yp(h.dir)}}(c))}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=Ki(n,e.limit);var a;return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),t}function mp(n){let e=lp(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ce(r===1);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=function(h){const d=th(h);return d instanceof je&&Tu(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(h=>function(d){return new Ht(Mt(d.field),function(l){switch(l){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction))}(h)));let a=null;t.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,ss(d)?null:d}(t.limit));let u=null;t.startAt&&(u=function(h){const d=!!h.before,l=h.values||[];return new Lr(l,d)}(t.startAt));let c=null;return t.endAt&&(c=function(h){const d=!h.before,l=h.values||[];return new Lr(l,d)}(t.endAt)),Px(e,s,o,i,a,"F",u,c)}function vp(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function th(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Mt(e.unaryFilter.field);return xe.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=Mt(e.unaryFilter.field);return xe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mt(e.unaryFilter.field);return xe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Mt(e.unaryFilter.field);return xe.create(i,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(n):n.fieldFilter!==void 0?function(e){return xe.create(Mt(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return je.create(e.compositeFilter.filters.map(t=>th(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return q()}}(e.compositeFilter.op))}(n):q()}function yp(n){return op[n]}function Ep(n){return ap[n]}function Cp(n){return cp[n]}function Pt(n){return{fieldPath:n.canonicalString()}}function Mt(n){return _e.fromServerFormat(n.fieldPath)}function nh(n){return n instanceof xe?function(e){if(e.op==="=="){if(I0(e.value))return{unaryFilter:{field:Pt(e.field),op:"IS_NAN"}};if(T0(e.value))return{unaryFilter:{field:Pt(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(I0(e.value))return{unaryFilter:{field:Pt(e.field),op:"IS_NOT_NAN"}};if(T0(e.value))return{unaryFilter:{field:Pt(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pt(e.field),op:Ep(e.op),value:e.value}}}(n):n instanceof je?function(e){const t=e.getFilters().map(r=>nh(r));return t.length===1?t[0]:{compositeFilter:{op:Cp(e.op),filters:t}}}(n):q()}function wp(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function rh(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,t,r,s,i=z.min(),o=z.min(),a=Te.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new it(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new it(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new it(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new it(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e){this.fe=e}}function Dp(n){const e=mp({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Or(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(){this.rn=new _p}addToCollectionParentIndex(e,t){return this.rn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(ht.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(ht.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class _p{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Se(ae.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Se(ae.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Yt(0)}static Mn(){return new Yt(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(){this.changes=new on(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Dn(r.mutation,s,Oe.empty(),pe.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Q()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Q()){const s=Ct();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=yn();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Ct();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Q()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=nt();const o=An(),a=An();return t.forEach((u,c)=>{const h=r.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof gt)?i=i.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Dn(h.mutation,c,h.mutation.getFieldMask(),pe.now())):o.set(c.key,Oe.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var d;return a.set(c,new bp(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const r=An();let s=new he((o,a)=>o-a),i=Q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=t.get(u);if(c===null)return;let h=r.get(u)||Oe.empty();h=a.applyToLocalView(c,h),r.set(u,h);const d=(s.get(a.batchId)||Q()).add(u);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,h=u.value,d=Uu();h.forEach(l=>{if(!i.has(l)){const f=Gu(t.get(l),r.get(l));f!==null&&d.set(l,f),i=i.add(l)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return function(s){return U.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Lu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):R.resolve(Ct());let a=-1,u=i;return o.next(c=>R.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(h)?R.resolve():this.remoteDocumentCache.getEntry(e,h).next(l=>{u=u.insert(h,l)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,Q())).next(h=>({batchId:a,changes:Vu(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next(r=>{let s=yn();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const s=t.collectionGroup;let i=yn();return this.indexManager.getCollectionParents(e,s).next(o=>R.forEach(o,a=>{const u=function(c,h){return new sn(h,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(t,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r).next(c=>{c.forEach((h,d)=>{i=i.insert(h,d)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s))).next(i=>{s.forEach((a,u)=>{const c=u.getKey();i.get(c)===null&&(i=i.insert(c,Be.newInvalidDocument(c)))});let o=yn();return i.forEach((a,u)=>{const c=s.get(a);c!==void 0&&Dn(c.mutation,u,Oe.empty(),pe.now()),as(t,u)&&(o=o.insert(a,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return R.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var r;return this.cs.set(t.id,{id:(r=t).id,version:r.version,createTime:Qe(r.createTime)}),R.resolve()}getNamedQuery(e,t){return R.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(r){return{name:r.name,query:Dp(r.bundledQuery),readTime:Qe(r.readTime)}}(t)),R.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(){this.overlays=new he(U.comparator),this.ls=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ct();return R.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.we(e,t,i)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.ls.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.ls.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const s=Ct(),i=t.length+1,o=new U(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return R.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new he((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=i.get(c.largestBatchId);h===null&&(h=Ct(),i=i.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Ct(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=s)););return R.resolve(a)}we(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.ls.get(s.largestBatchId).delete(r.key);this.ls.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ep(t,r));let i=this.ls.get(t);i===void 0&&(i=Q(),this.ls.set(t,i)),this.ls.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(){this.fs=new Se(ge.ds),this.ws=new Se(ge._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const r=new ge(e,t);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ys(new ge(e,t))}ps(e,t){e.forEach(r=>this.removeReference(r,t))}Is(e){const t=new U(new ae([])),r=new ge(t,e),s=new ge(t,e+1),i=[];return this.ws.forEachInRange([r,s],o=>{this.ys(o),i.push(o.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new U(new ae([])),r=new ge(t,e),s=new ge(t,e+1);let i=Q();return this.ws.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new ge(e,0),r=this.fs.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ge{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return U.comparator(e.key,t.key)||Z(e.As,t.As)}static _s(e,t){return Z(e.As,t.As)||U.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Se(ge.ds)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Jx(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Rs=this.Rs.add(new ge(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,t){return R.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.bs(r),i=s<0?0:s;return R.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ge(t,0),s=new ge(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,s],o=>{const a=this.Ps(o.As);i.push(a)}),R.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Se(Z);return t.forEach(s=>{const i=new ge(s,0),o=new ge(s,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([i,o],a=>{r=r.add(a.As)})}),R.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;U.isDocumentKey(i)||(i=i.child(""));const o=new ge(new U(i),0);let a=new Se(Z);return this.Rs.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(u.As)),!0)},o),R.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(r=>{const s=this.Ps(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ce(this.Ss(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return R.forEach(t.mutations,s=>{const i=new ge(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,t){const r=new ge(t,0),s=this.Rs.firstAfterOrEqual(r);return R.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Ss(e,t){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e){this.Ds=e,this.docs=new he(U.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Ds(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():Be.newInvalidDocument(t))}getEntries(e,t){let r=nt();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Be.newInvalidDocument(s))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=nt();const o=t.path,a=new U(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:h}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Ex(yx(h),r)<=0||(s.has(h.key)||as(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return R.resolve(i)}getAllFromCollectionGroup(e,t,r,s){q()}Cs(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Rp(this)}getSize(e){return R.resolve(this.size)}}class Rp extends Fp{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.os.addEntry(e,s)):this.os.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e){this.persistence=e,this.xs=new on(t=>To(t),Io),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Mo,this.targetCount=0,this.Ms=Yt.kn()}forEachTarget(e,t){return this.xs.forEach((r,s)=>t(s)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ns&&(this.Ns=t),R.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Yt(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Fn(t),R.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.xs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),R.waitFor(i).next(()=>s)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.xs.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.ks.gs(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.ks.ps(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),R.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ks.Es(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.ks.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,t){this.$s={},this.overlays={},this.Os=new _o(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Lp(this),this.indexManager=new Bp,this.remoteDocumentCache=function(r){return new Np(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new Ap(t),this.qs=new Tp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ip,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.$s[e.toKey()];return r||(r=new kp(t,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const s=new Pp(this.Os.next());return this.referenceDelegate.Us(),r(s).next(i=>this.referenceDelegate.Ks(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gs(e,t){return R.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,t)))}}class Pp extends wx{constructor(e){super(),this.currentSequenceNumber=e}}class Vo{constructor(e){this.persistence=e,this.Qs=new Mo,this.js=null}static zs(e){return new Vo(e)}get Ws(){if(this.js)return this.js;throw q()}addReference(e,t,r){return this.Qs.addReference(r,t),this.Ws.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Qs.removeReference(r,t),this.Ws.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),R.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(s=>this.Ws.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Ws.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Ws,r=>{const s=U.fromPath(r);return this.Hs(e,s).next(i=>{i||t.removeEntry(s,z.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(r=>{r?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return R.or([()=>R.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Fi=r,this.Bi=s}static Li(e,t){let r=Q(),s=Q();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Uo(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,r,s){return this.Ki(e,t).next(i=>i||this.Gi(e,t,s,r)).next(i=>i||this.Qi(e,t))}Ki(e,t){if(L0(t))return R.resolve(null);let r=tt(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Or(t,null,"F"),r=tt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Q(...i);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ji(t,a);return this.zi(t,c,o,u.readTime)?this.Ki(e,Or(t,null,"F")):this.Wi(e,c,t,u)}))})))}Gi(e,t,r,s){return L0(t)||s.isEqual(z.min())?this.Qi(e,t):this.Ui.getDocuments(e,r).next(i=>{const o=this.ji(t,i);return this.zi(t,o,r,s)?this.Qi(e,t):(B0()<=J.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ji(t)),this.Wi(e,o,t,vx(s,-1)))})}ji(e,t){let r=new Se(Pu(e));return t.forEach((s,i)=>{as(e,i)&&(r=r.add(i))}),r}zi(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Qi(e,t){return B0()<=J.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",ji(t)),this.Ui.getDocumentsMatchingQuery(e,t,ht.min())}Wi(e,t,r,s){return this.Ui.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,t,r,s){this.persistence=e,this.Hi=t,this.serializer=s,this.Ji=new he(Z),this.Yi=new on(i=>To(i),Io),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Sp(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function Up(n,e,t,r){return new Vp(n,e,t,r)}async function sh(n,e){const t=j(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.tr(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=Q();for(const c of s){o.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}for(const c of i){a.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next(c=>({er:c,removedBatchIds:o,addedBatchIds:a}))})})}function $p(n,e){const t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,u,c){const h=u.batch,d=h.keys();let l=R.resolve();return d.forEach(f=>{l=l.next(()=>c.getEntry(a,f)).next(x=>{const v=u.docVersions.get(f);ce(v!==null),x.version.compareTo(v)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),c.addEntry(x)))})}),l.next(()=>o.mutationQueue.removeMutationBatch(a,h))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=Q();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(a=a.add(o.batch.mutations[u].key));return a}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function ih(n){const e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function qp(n,e){const t=j(n),r=e.snapshotVersion;let s=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});s=t.Ji;const a=[];e.targetChanges.forEach((h,d)=>{const l=s.get(d);if(!l)return;a.push(t.Bs.removeMatchingKeys(i,h.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(i,h.addedDocuments,d)));let f=l.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Te.EMPTY_BYTE_STRING,z.min()).withLastLimboFreeSnapshotVersion(z.min()):h.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(h.resumeToken,r)),s=s.insert(d,f),function(x,v,g){return x.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(l,f,h)&&a.push(t.Bs.updateTargetData(i,f))});let u=nt(),c=Q();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(Hp(i,o,e.documentUpdates).next(h=>{u=h.nr,c=h.sr})),!r.isEqual(z.min())){const h=t.Bs.getLastRemoteSnapshotVersion(i).next(d=>t.Bs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return R.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(t.Ji=s,i))}function Hp(n,e,t){let r=Q(),s=Q();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=nt();return t.forEach((a,u)=>{const c=i.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(z.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):M("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{nr:o,sr:s}})}function zp(n,e){const t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function jp(n,e){const t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Bs.getTargetData(r,e).next(i=>i?(s=i,R.resolve(s)):t.Bs.allocateTargetId(r).next(o=>(s=new it(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Bs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}async function Xi(n,e,t){const r=j(n),s=r.Ji.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Yn(o))throw o;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(s.target)}function K0(n,e,t){const r=j(n);let s=z.min(),i=Q();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,u,c){const h=j(a),d=h.Yi.get(c);return d!==void 0?R.resolve(h.Ji.get(d)):h.Bs.getTargetData(u,c)}(r,o,tt(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,t?s:z.min(),t?i:Q())).next(a=>(Kp(r,Mx(e),a),{documents:a,ir:i})))}function Kp(n,e,t){let r=n.Xi.get(e)||z.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Xi.set(e,r)}class G0{constructor(){this.activeTargetIds=zx()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gp{constructor(){this.Hr=new G0,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,r){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new G0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pr=null;function mi(){return pr===null?pr=268435456+Math.round(2147483648*Math.random()):pr++,"0x"+pr.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ae="WebChannelConnection";class Yp extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,r,s,i){const o=mi(),a=this.To(e,t);M("RestConnection",`Sending RPC '${e}' ${o}:`,a,r);const u={};return this.Eo(u,s,i),this.Ao(e,a,u,r).then(c=>(M("RestConnection",`Received RPC '${e}' ${o}: `,c),c),c=>{throw Gt("RestConnection",`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",r),c})}vo(e,t,r,s,i,o){return this.Io(e,t,r,s,i)}Eo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+rn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}To(e,t){const r=Qp[e];return`${this.mo}/v1/${t}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,r,s){const i=mi();return new Promise((o,a)=>{const u=new ax;u.setWithCredentials(!0),u.listenOnce(sx.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case pi.NO_ERROR:const h=u.getResponseJson();M(Ae,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case pi.TIMEOUT:M(Ae,`RPC '${e}' ${i} timed out`),a(new P(F.DEADLINE_EXCEEDED,"Request time out"));break;case pi.HTTP_ERROR:const d=u.getStatus();if(M(Ae,`RPC '${e}' ${i} failed with status:`,d,"response text:",u.getResponseText()),d>0){let l=u.getResponseJson();Array.isArray(l)&&(l=l[0]);const f=l==null?void 0:l.error;if(f&&f.status&&f.message){const x=function(v){const g=v.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(g)>=0?g:F.UNKNOWN}(f.status);a(new P(x,f.message))}else a(new P(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new P(F.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{M(Ae,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);M(Ae,`RPC '${e}' ${i} sending request:`,s),u.send(t,"POST",c,r,15)})}Ro(e,t,r){const s=mi(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=nx(),a=rx(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new ox({})),this.Eo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=i.join("");M(Ae,`Creating RPC '${e}' stream ${s}: ${h}`,u);const d=o.createWebChannel(h,u);let l=!1,f=!1;const x=new Xp({ro:g=>{f?M(Ae,`Not sending because RPC '${e}' stream ${s} is closed:`,g):(l||(M(Ae,`Opening RPC '${e}' stream ${s} transport.`),d.open(),l=!0),M(Ae,`RPC '${e}' stream ${s} sending:`,g),d.send(g))},oo:()=>d.close()}),v=(g,E,p)=>{g.listen(E,m=>{try{p(m)}catch(y){setTimeout(()=>{throw y},0)}})};return v(d,lr.EventType.OPEN,()=>{f||M(Ae,`RPC '${e}' stream ${s} transport opened.`)}),v(d,lr.EventType.CLOSE,()=>{f||(f=!0,M(Ae,`RPC '${e}' stream ${s} transport closed`),x.wo())}),v(d,lr.EventType.ERROR,g=>{f||(f=!0,Gt(Ae,`RPC '${e}' stream ${s} transport errored:`,g),x.wo(new P(F.UNAVAILABLE,"The operation could not be completed")))}),v(d,lr.EventType.MESSAGE,g=>{var E;if(!f){const p=g.data[0];ce(!!p);const m=p,y=m.error||((E=m[0])===null||E===void 0?void 0:E.error);if(y){M(Ae,`RPC '${e}' stream ${s} received error:`,y);const A=y.status;let w=function(_){const L=fe[_];if(L!==void 0)return Qu(L)}(A),D=y.message;w===void 0&&(w=F.INTERNAL,D="Unknown error status: "+A+" with message "+y.message),f=!0,x.wo(new P(w,D)),d.close()}else M(Ae,`RPC '${e}' stream ${s} received:`,p),x._o(p)}}),v(a,ix.STAT_EVENT,g=>{g.stat===A0.PROXY?M(Ae,`RPC '${e}' stream ${s} detected buffering proxy`):g.stat===A0.NOPROXY&&M(Ae,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.fo()},0),x}}function vi(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n){return new up(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ii=e,this.timerId=t,this.Po=r,this.bo=s,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),s=Math.max(0,t-r);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,t,r,s,i,o,a,u){this.ii=e,this.$o=r,this.Oo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new oh(e,t)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(et(t.toString()),et("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Fo===t&&this.Zo(r,s)},r=>{e(()=>{const s=new P(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(s)})})}Zo(e,t){const r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(s=>{r(()=>this.tu(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Zp extends ah{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=fp(this.serializer,e),r=function(s){if(!("targetChange"in s))return z.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?z.min():i.readTime?Qe(i.readTime):z.min()}(e);return this.listener.nu(t,r)}su(e){const t={};t.database=Qi(this.serializer),t.addTarget=function(s,i){let o;const a=i.target;if(o=Hi(a)?{documents:pp(s,a)}:{query:gp(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=Zu(s,i.resumeToken);const u=Ki(s,i.expectedCount);u!==null&&(o.expectedCount=u)}else if(i.snapshotVersion.compareTo(z.min())>0){o.readTime=Vr(s,i.snapshotVersion.toTimestamp());const u=Ki(s,i.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const r=vp(this.serializer,e);r&&(t.labels=r),this.Wo(t)}iu(e){const t={};t.database=Qi(this.serializer),t.removeTarget=e,this.Wo(t)}}class Jp extends ah{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(ce(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=xp(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.cu(r,t)}return ce(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Qi(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>dp(this.serializer,r))};this.Wo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new P(F.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Io(e,t,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(F.UNKNOWN,s.toString())})}vo(e,t,r,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.vo(e,t,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new P(F.UNKNOWN,i.toString())})}terminate(){this.lu=!0}}class t1{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(et(t),this.mu=!1):M("OnlineStateTracker",t)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(o=>{r.enqueueAndForget(async()=>{kt(this)&&(M("RemoteStore","Restarting streams for network reachability change."),await async function(a){const u=j(a);u.vu.add(4),await er(u),u.bu.set("Unknown"),u.vu.delete(4),await fs(u)}(this))})}),this.bu=new t1(r,s)}}async function fs(n){if(kt(n))for(const e of n.Ru)await e(!0)}async function er(n){for(const e of n.Ru)await e(!1)}function ch(n,e){const t=j(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),Ho(t)?qo(t):an(t).Ko()&&$o(t,e))}function uh(n,e){const t=j(n),r=an(t);t.Au.delete(e),r.Ko()&&hh(t,e),t.Au.size===0&&(r.Ko()?r.jo():kt(t)&&t.bu.set("Unknown"))}function $o(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(z.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}an(n).su(e)}function hh(n,e){n.Vu.qt(e),an(n).iu(e)}function qo(n){n.Vu=new ip({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),an(n).start(),n.bu.gu()}function Ho(n){return kt(n)&&!an(n).Uo()&&n.Au.size>0}function kt(n){return j(n).vu.size===0}function lh(n){n.Vu=void 0}async function r1(n){n.Au.forEach((e,t)=>{$o(n,e)})}async function s1(n,e){lh(n),Ho(n)?(n.bu.Iu(e),qo(n)):n.bu.set("Unknown")}async function i1(n,e,t){if(n.bu.set("Online"),e instanceof Yu&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.Au.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.Au.delete(o),r.Vu.removeTarget(o))}(n,e)}catch(r){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ur(n,r)}else if(e instanceof wr?n.Vu.Ht(e):e instanceof Xu?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(z.min()))try{const r=await ih(n.localStore);t.compareTo(r)>=0&&await function(s,i){const o=s.Vu.ce(i);return o.targetChanges.forEach((a,u)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.Au.get(u);c&&s.Au.set(u,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach((a,u)=>{const c=s.Au.get(a);if(!c)return;s.Au.set(a,c.withResumeToken(Te.EMPTY_BYTE_STRING,c.snapshotVersion)),hh(s,a);const h=new it(c.target,a,u,c.sequenceNumber);$o(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){M("RemoteStore","Failed to raise snapshot:",r),await Ur(n,r)}}async function Ur(n,e,t){if(!Yn(e))throw e;n.vu.add(1),await er(n),n.bu.set("Offline"),t||(t=()=>ih(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{M("RemoteStore","Retrying IndexedDB access"),await t(),n.vu.delete(1),await fs(n)})}function fh(n,e){return e().catch(t=>Ur(n,t,e))}async function ds(n){const e=j(n),t=ft(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;o1(e);)try{const s=await zp(e.localStore,r);if(s===null){e.Eu.length===0&&t.jo();break}r=s.batchId,a1(e,s)}catch(s){await Ur(e,s)}dh(e)&&xh(e)}function o1(n){return kt(n)&&n.Eu.length<10}function a1(n,e){n.Eu.push(e);const t=ft(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function dh(n){return kt(n)&&!ft(n).Uo()&&n.Eu.length>0}function xh(n){ft(n).start()}async function c1(n){ft(n).hu()}async function u1(n){const e=ft(n);for(const t of n.Eu)e.uu(t.mutations)}async function h1(n,e,t){const r=n.Eu.shift(),s=Ro.from(r,e,t);await fh(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await ds(n)}async function l1(n,e){e&&ft(n).ou&&await async function(t,r){if(s=r.code,np(s)&&s!==F.ABORTED){const i=t.Eu.shift();ft(t).Qo(),await fh(t,()=>t.remoteSyncer.rejectFailedWrite(i.batchId,r)),await ds(t)}var s}(n,e),dh(n)&&xh(n)}async function Q0(n,e){const t=j(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");const r=kt(t);t.vu.add(3),await er(t),r&&t.bu.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),await fs(t)}async function f1(n,e){const t=j(n);e?(t.vu.delete(2),await fs(t)):e||(t.vu.add(2),await er(t),t.bu.set("Unknown"))}function an(n){return n.Su||(n.Su=function(e,t,r){const s=j(e);return s.fu(),new Zp(t,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{uo:r1.bind(null,n),ao:s1.bind(null,n),nu:i1.bind(null,n)}),n.Ru.push(async e=>{e?(n.Su.Qo(),Ho(n)?qo(n):n.bu.set("Unknown")):(await n.Su.stop(),lh(n))})),n.Su}function ft(n){return n.Du||(n.Du=function(e,t,r){const s=j(e);return s.fu(),new Jp(t,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{uo:c1.bind(null,n),ao:l1.bind(null,n),au:u1.bind(null,n),cu:h1.bind(null,n)}),n.Ru.push(async e=>{e?(n.Du.Qo(),await ds(n)):(await n.Du.stop(),n.Eu.length>0&&(M("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))})),n.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new zo(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jo(n,e){if(et("AsyncQueue",`${e}: ${n}`),Yn(n))return new P(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=yn(),this.sortedSet=new he(this.comparator)}static emptySet(e){return new jt(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new jt;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(){this.Cu=new he(U.comparator)}track(e){const t=e.doc.key,r=this.Cu.get(t);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(t,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(t):e.type===1&&r.type===2?this.Cu=this.Cu.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):q():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Zt{constructor(e,t,r,s,i,o,a,u,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Zt(e,t,jt.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&os(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(){this.Nu=void 0,this.listeners=[]}}class x1{constructor(){this.queries=new on(e=>Ou(e),os),this.onlineState="Unknown",this.ku=new Set}}async function p1(n,e){const t=j(n),r=e.query;let s=!1,i=t.queries.get(r);if(i||(s=!0,i=new d1),s)try{i.Nu=await t.onListen(r)}catch(o){const a=jo(o,`Initialization of query '${ji(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,i),i.listeners.push(e),e.Mu(t.onlineState),i.Nu&&e.$u(i.Nu)&&Ko(t)}async function g1(n,e){const t=j(n),r=e.query;let s=!1;const i=t.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return t.queries.delete(r),t.onUnlisten(r)}function m1(n,e){const t=j(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.listeners)a.$u(s)&&(r=!0);o.Nu=s}}r&&Ko(t)}function v1(n,e,t){const r=j(n),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(t);r.queries.delete(e)}function Ko(n){n.ku.forEach(e=>{e.next()})}class y1{constructor(e,t,r){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Zt(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Uu(e){e=Zt.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e){this.key=e}}class gh{constructor(e){this.key=e}}class E1{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Q(),this.mutatedKeys=Q(),this.tc=Pu(e),this.ec=new jt(this.tc)}get nc(){return this.Yu}sc(e,t){const r=t?t.ic:new X0,s=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,d)=>{const l=s.get(h),f=as(this.query,d)?d:null,x=!!l&&this.mutatedKeys.has(l.key),v=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let g=!1;l&&f?l.data.isEqual(f.data)?x!==v&&(r.track({type:3,doc:f}),g=!0):this.rc(l,f)||(r.track({type:2,doc:f}),g=!0,(u&&this.tc(f,u)>0||c&&this.tc(f,c)<0)&&(a=!0)):!l&&f?(r.track({type:0,doc:f}),g=!0):l&&!f&&(r.track({type:1,doc:l}),g=!0,(u||c)&&(a=!0)),g&&(f?(o=o.add(f),i=v?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{ec:o,ic:r,zi:a,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const s=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((c,h)=>function(d,l){const f=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return f(d)-f(l)}(c.type,h.type)||this.tc(c.doc,h.doc)),this.oc(r);const o=t?this.uc():[],a=this.Zu.size===0&&this.current?1:0,u=a!==this.Xu;return this.Xu=a,i.length!==0||u?{snapshot:new Zt(this.query,e.ec,s,i,e.mutatedKeys,a===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new X0,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Q(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const t=[];return e.forEach(r=>{this.Zu.has(r)||t.push(new gh(r))}),this.Zu.forEach(r=>{e.has(r)||t.push(new ph(r))}),t}hc(e){this.Yu=e.ir,this.Zu=Q();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Zt.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class C1{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class w1{constructor(e){this.key=e,this.fc=!1}}class A1{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new on(a=>Ou(a),os),this._c=new Map,this.mc=new Set,this.gc=new he(U.comparator),this.yc=new Map,this.Ic=new Mo,this.Tc={},this.Ec=new Map,this.Ac=Yt.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function D1(n,e){const t=R1(n);let r,s;const i=t.wc.get(e);if(i)r=i.targetId,t.sharedClientState.addLocalQueryTarget(r),s=i.view.lc();else{const o=await jp(t.localStore,tt(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await B1(t,e,r,a==="current",o.resumeToken),t.isPrimaryClient&&ch(t.remoteStore,o)}return s}async function B1(n,e,t,r,s){n.Rc=(d,l,f)=>async function(x,v,g,E){let p=v.view.sc(g);p.zi&&(p=await K0(x.localStore,v.query,!1).then(({documents:A})=>v.view.sc(A,p)));const m=E&&E.targetChanges.get(v.targetId),y=v.view.applyChanges(p,x.isPrimaryClient,m);return Z0(x,v.targetId,y.cc),y.snapshot}(n,d,l,f);const i=await K0(n.localStore,e,!0),o=new E1(e,i.ir),a=o.sc(i.documents),u=Jn.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,u);Z0(n,t,c.cc);const h=new C1(e,t,o);return n.wc.set(e,h),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),c.snapshot}async function _1(n,e){const t=j(n),r=t.wc.get(e),s=t._c.get(r.targetId);if(s.length>1)return t._c.set(r.targetId,s.filter(i=>!os(i,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await Xi(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),uh(t.remoteStore,r.targetId),Yi(t,r.targetId)}).catch(Xn)):(Yi(t,r.targetId),await Xi(t.localStore,r.targetId,!0))}async function F1(n,e,t){const r=L1(n);try{const s=await function(i,o){const a=j(i),u=pe.now(),c=o.reduce((l,f)=>l.add(f.key),Q());let h,d;return a.persistence.runTransaction("Locally write mutations","readwrite",l=>{let f=nt(),x=Q();return a.Zi.getEntries(l,c).next(v=>{f=v,f.forEach((g,E)=>{E.isValidDocument()||(x=x.add(g))})}).next(()=>a.localDocuments.getOverlayedDocuments(l,f)).next(v=>{h=v;const g=[];for(const E of o){const p=Yx(E,h.get(E.key).overlayedDocument);p!=null&&g.push(new gt(E.key,p,Fu(p.value.mapValue),He.exists(!0)))}return a.mutationQueue.addMutationBatch(l,u,g,o)}).next(v=>{d=v;const g=v.applyToLocalDocumentSet(h,x);return a.documentOverlayCache.saveOverlays(l,v.batchId,g)})}).then(()=>({batchId:d.batchId,changes:Vu(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let u=i.Tc[i.currentUser.toKey()];u||(u=new he(Z)),u=u.insert(o,a),i.Tc[i.currentUser.toKey()]=u}(r,s.batchId,t),await tr(r,s.changes),await ds(r.remoteStore)}catch(s){const i=jo(s,"Failed to persist write");t.reject(i)}}async function mh(n,e){const t=j(n);try{const r=await qp(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.yc.get(i);o&&(ce(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.fc=!0:s.modifiedDocuments.size>0?ce(o.fc):s.removedDocuments.size>0&&(ce(o.fc),o.fc=!1))}),await tr(t,r,e)}catch(r){await Xn(r)}}function Y0(n,e,t){const r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.wc.forEach((i,o)=>{const a=o.view.Mu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=j(i);a.onlineState=o;let u=!1;a.queries.forEach((c,h)=>{for(const d of h.listeners)d.Mu(o)&&(u=!0)}),u&&Ko(a)}(r.eventManager,e),s.length&&r.dc.nu(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function b1(n,e,t){const r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.yc.get(e),i=s&&s.key;if(i){let o=new he(U.comparator);o=o.insert(i,Be.newNoDocument(i,z.min()));const a=Q().add(i),u=new hs(z.min(),new Map,new he(Z),o,a);await mh(r,u),r.gc=r.gc.remove(i),r.yc.delete(e),Go(r)}else await Xi(r.localStore,e,!1).then(()=>Yi(r,e,t)).catch(Xn)}async function S1(n,e){const t=j(n),r=e.batch.batchId;try{const s=await $p(t.localStore,e);yh(t,r,null),vh(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await tr(t,s)}catch(s){await Xn(s)}}async function T1(n,e,t){const r=j(n);try{const s=await function(i,o){const a=j(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return a.mutationQueue.lookupMutationBatch(u,o).next(h=>(ce(h!==null),c=h.keys(),a.mutationQueue.removeMutationBatch(u,h))).next(()=>a.mutationQueue.performConsistencyCheck(u)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(u,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>a.localDocuments.getDocuments(u,c))})}(r.localStore,e);yh(r,e,t),vh(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await tr(r,s)}catch(s){await Xn(s)}}function vh(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function yh(n,e,t){const r=j(n);let s=r.Tc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Tc[r.currentUser.toKey()]=s}}function Yi(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n._c.get(e))n.wc.delete(r),t&&n.dc.Pc(r,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(r=>{n.Ic.containsKey(r)||Eh(n,r)})}function Eh(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);t!==null&&(uh(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),Go(n))}function Z0(n,e,t){for(const r of t)r instanceof ph?(n.Ic.addReference(r.key,e),I1(n,r)):r instanceof gh?(M("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,e),n.Ic.containsKey(r.key)||Eh(n,r.key)):q()}function I1(n,e){const t=e.key,r=t.path.canonicalString();n.gc.get(t)||n.mc.has(r)||(M("SyncEngine","New document in limbo: "+t),n.mc.add(r),Go(n))}function Go(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new U(ae.fromString(e)),r=n.Ac.next();n.yc.set(r,new w1(t)),n.gc=n.gc.insert(t,r),ch(n.remoteStore,new it(tt(Ru(t.path)),r,"TargetPurposeLimboResolution",_o.ct))}}async function tr(n,e,t){const r=j(n),s=[],i=[],o=[];r.wc.isEmpty()||(r.wc.forEach((a,u)=>{o.push(r.Rc(u,e,t).then(c=>{if((c||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c!=null&&c.fromCache?"not-current":"current"),c){s.push(c);const h=Uo.Li(u.targetId,c);i.push(h)}}))}),await Promise.all(o),r.dc.nu(s),await async function(a,u){const c=j(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>R.forEach(u,d=>R.forEach(d.Fi,l=>c.persistence.referenceDelegate.addReference(h,d.targetId,l)).next(()=>R.forEach(d.Bi,l=>c.persistence.referenceDelegate.removeReference(h,d.targetId,l)))))}catch(h){if(!Yn(h))throw h;M("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const l=c.Ji.get(d),f=l.snapshotVersion,x=l.withLastLimboFreeSnapshotVersion(f);c.Ji=c.Ji.insert(d,x)}}}(r.localStore,i))}async function k1(n,e){const t=j(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());const r=await sh(t.localStore,e);t.currentUser=e,function(s,i){s.Ec.forEach(o=>{o.forEach(a=>{a.reject(new P(F.CANCELLED,i))})}),s.Ec.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await tr(t,r.er)}}function N1(n,e){const t=j(n),r=t.yc.get(e);if(r&&r.fc)return Q().add(r.key);{let s=Q();const i=t._c.get(e);if(!i)return s;for(const o of i){const a=t.wc.get(o);s=s.unionWith(a.view.nc)}return s}}function R1(n){const e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=mh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b1.bind(null,e),e.dc.nu=m1.bind(null,e.eventManager),e.dc.Pc=v1.bind(null,e.eventManager),e}function L1(n){const e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=S1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=T1.bind(null,e),e}class J0{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ls(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Up(this.persistence,new Mp,e.initialUser,this.serializer)}createPersistence(e){return new Op(Vo.zs,this.serializer)}createSharedClientState(e){return new Gp}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class O1{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Y0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=k1.bind(null,this.syncEngine),await f1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new x1}createDatastore(e){const t=ls(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new Yp(s));var s;return function(i,o,a,u){return new e1(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>Y0(this.syncEngine,a,0),o=W0.D()?new W0:new Wp,new n1(t,r,s,i,o);var t,r,s,i,o}createSyncEngine(e,t){return function(r,s,i,o,a,u,c){const h=new A1(r,s,i,o,a,u);return c&&(h.vc=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=j(e);M("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await er(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):et("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e,t,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=De.UNAUTHENTICATED,this.clientId=Du.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{M("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(M("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new P(F.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=jo(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function yi(n,e){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await sh(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ec(n,e){n.asyncQueue.verifyOperationInProgress();const t=await U1(n);M("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(s=>Q0(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>Q0(e.remoteStore,i)),n._onlineComponents=e}function V1(n){return n.name==="FirebaseError"?n.code===F.FAILED_PRECONDITION||n.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function U1(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{await yi(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!V1(t))throw t;Gt("Error using user provided cache. Falling back to memory cache: "+t),await yi(n,new J0)}}else M("FirestoreClient","Using default OfflineComponentProvider"),await yi(n,new J0);return n._offlineComponents}async function Ch(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),await ec(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),await ec(n,new O1))),n._onlineComponents}function $1(n){return Ch(n).then(e=>e.syncEngine)}async function q1(n){const e=await Ch(n),t=e.eventManager;return t.onListen=D1.bind(null,e.syncEngine),t.onUnlisten=_1.bind(null,e.syncEngine),t}function H1(n,e,t={}){const r=new ct;return n.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,u){const c=new P1({next:d=>{i.enqueueAndForget(()=>g1(s,h)),d.fromCache&&a.source==="server"?u.reject(new P(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new y1(o,c,{includeMetadataChanges:!0,Ku:!0});return p1(s,h)}(await q1(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(n,e,t){if(!t)throw new P(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function z1(n,e,t,r){if(e===!0&&r===!0)throw new P(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function nc(n){if(!U.isDocumentKey(n))throw new P(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rc(n){if(U.isDocumentKey(n))throw new P(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xs(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":q()}function Ft(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xs(n);throw new P(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function j1(n,e){if(e<=0)throw new P(F.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}z1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wh((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new P(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new P(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new P(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,r}}class ps{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sc({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new P(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new P(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sc(e),e.credentials!==void 0&&(this._authCredentials=function(t){if(!t)return new ux;switch(t.type){case"firstParty":return new dx(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new P(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=tc.get(e);t&&(M("ComponentProvider","Removing Datastore"),tc.delete(e),t.terminate())}(this),Promise.resolve()}}function K1(n,e,t,r={}){var s;const i=(n=Ft(n,ps))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Gt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=De.MOCK_USER;else{a=$l(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new P(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new De(c)}n._authCredentials=new hx(new Au(a,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ut(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pe(this.firestore,e,this._key)}}class mt{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mt(this.firestore,e,this._query)}}class ut extends mt{constructor(e,t,r){super(e,t,Ru(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new U(e))}withConverter(e){return new ut(this.firestore,e,this._path)}}function Ei(n,e,...t){if(n=Ze(n),Ah("collection","path",e),n instanceof ps){const r=ae.fromString(e,...t);return rc(r),new ut(n,null,r)}{if(!(n instanceof Pe||n instanceof ut))throw new P(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ae.fromString(e,...t));return rc(r),new ut(n.firestore,null,r)}}function G1(n,e,...t){if(n=Ze(n),arguments.length===1&&(e=Du.A()),Ah("doc","path",e),n instanceof ps){const r=ae.fromString(e,...t);return nc(r),new Pe(n,null,new U(r))}{if(!(n instanceof Pe||n instanceof ut))throw new P(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ae.fromString(e,...t));return nc(r),new Pe(n.firestore,n instanceof ut?n.converter:null,new U(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new oh(this,"async_queue_retry"),this.Xc=()=>{const t=vi();t&&M("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=vi();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=vi();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new ct;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Yn(e))throw e;M("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw et("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Hc=!1,r))));return this.Gc=t,t}enqueueAfterDelay(e,t,r){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const s=zo.createAndSchedule(this,e,t,r,i=>this.na(i));return this.zc.push(s),s}Zc(){this.Wc&&q()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}class nr extends ps{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new W1,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Bh(this),this._firestoreClient.terminate()}}function Q1(n,e){const t=typeof n=="object"?n:Kf(),r=typeof n=="string"?n:e||"(default)",s=qf(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Vl("firestore");i&&K1(s,...i)}return s}function Dh(n){return n._firestoreClient||Bh(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Bh(n){var e,t,r;const s=n._freezeSettings(),i=function(o,a,u,c){return new Bx(o,a,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,wh(c.experimentalLongPollingOptions),c.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._firestoreClient=new M1(n._authCredentials,n._appCheckCredentials,n._queue,i),!((t=s.cache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jt(Te.fromBase64String(e))}catch(t){throw new P(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jt(Te.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _e(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1=/^__.*__$/;class Y1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zn(e,this.data,t,this.fieldTransforms)}}class _h{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Fh(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}class Xo{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Xo(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.aa({path:r,la:!1});return s.fa(e),s}da(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.aa({path:r,la:!1});return s.ua(),s}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return $r(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(Fh(this.ca)&&X1.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Z1{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ls(e)}ya(e,t,r,s=!1){return new Xo({ca:e,methodName:t,ga:r,path:_e.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yo(n){const e=n._freezeSettings(),t=ls(n._databaseId);return new Z1(n._databaseId,!!e.ignoreUndefinedProperties,t)}function J1(n,e,t,r,s,i={}){const o=n.ya(i.merge||i.mergeFields?2:0,e,t,s);Zo("Data must be an object, but it was:",o,r);const a=bh(r,o);let u,c;if(i.merge)u=new Oe(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const l=Zi(e,d,t);if(!o.contains(l))throw new P(F.INVALID_ARGUMENT,`Field '${l}' is specified in your field mask but missing from your input data.`);Th(h,l)||h.push(l)}u=new Oe(h),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new Y1(new Ne(a),u,c)}class ms extends Wo{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ms}}function eg(n,e,t,r){const s=n.ya(1,e,t);Zo("Data must be an object, but it was:",s,r);const i=[],o=Ne.empty();It(r,(u,c)=>{const h=Jo(e,u,t);c=Ze(c);const d=s.da(h);if(c instanceof ms)i.push(h);else{const l=rr(c,d);l!=null&&(i.push(h),o.set(h,l))}});const a=new Oe(i);return new _h(o,a,s.fieldTransforms)}function tg(n,e,t,r,s,i){const o=n.ya(1,e,t),a=[Zi(e,r,t)],u=[s];if(i.length%2!=0)throw new P(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let l=0;l<i.length;l+=2)a.push(Zi(e,i[l])),u.push(i[l+1]);const c=[],h=Ne.empty();for(let l=a.length-1;l>=0;--l)if(!Th(c,a[l])){const f=a[l];let x=u[l];x=Ze(x);const v=o.da(f);if(x instanceof ms)c.push(f);else{const g=rr(x,v);g!=null&&(c.push(f),h.set(f,g))}}const d=new Oe(c);return new _h(h,d,o.fieldTransforms)}function ng(n,e,t,r=!1){return rr(t,n.ya(r?4:3,e))}function rr(n,e){if(Sh(n=Ze(n)))return Zo("Unsupported field value:",e,n),bh(n,e);if(n instanceof Wo)return function(t,r){if(!Fh(r.ca))throw r._a(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${t._methodName}() is not currently supported inside arrays`);const s=t._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(t,r){const s=[];let i=0;for(const o of t){let a=rr(o,r.wa(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(n,e)}return function(t,r){if((t=Ze(t))===null)return{nullValue:"NULL_VALUE"};if(typeof t=="number")return jx(r.serializer,t);if(typeof t=="boolean")return{booleanValue:t};if(typeof t=="string")return{stringValue:t};if(t instanceof Date){const s=pe.fromDate(t);return{timestampValue:Vr(r.serializer,s)}}if(t instanceof pe){const s=new pe(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vr(r.serializer,s)}}if(t instanceof Qo)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Jt)return{bytesValue:Zu(r.serializer,t._byteString)};if(t instanceof Pe){const s=r.databaseId,i=t.firestore._databaseId;if(!i.isEqual(s))throw r._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Po(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r._a(`Unsupported field value: ${xs(t)}`)}(n,e)}function bh(n,e){const t={};return Bu(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):It(n,(r,s)=>{const i=rr(s,e.ha(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function Sh(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pe||n instanceof Qo||n instanceof Jt||n instanceof Pe||n instanceof Wo)}function Zo(n,e,t){if(!Sh(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const r=xs(t);throw r==="an object"?e._a(n+" a custom object"):e._a(n+" "+r)}}function Zi(n,e,t){if((e=Ze(e))instanceof gs)return e._internalPath;if(typeof e=="string")return Jo(n,e);throw $r("Field path arguments must be of type string or ",n,!1,void 0,t)}const rg=new RegExp("[~\\*/\\[\\]]");function Jo(n,e,t){if(e.search(rg)>=0)throw $r(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gs(...e.split("."))._internalPath}catch{throw $r(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $r(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new P(F.INVALID_ARGUMENT,a+n+u)}function Th(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(vs("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class sg extends Ih{data(){return super.data()}}function vs(n,e){return typeof e=="string"?Jo(n,e):e instanceof gs?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ea{}class ta extends ea{}function gr(n,e,...t){let r=[];e instanceof ea&&r.push(e),r=r.concat(t),function(s){const i=s.filter(a=>a instanceof na).length,o=s.filter(a=>a instanceof ys).length;if(i>1||i>0&&o>0)throw new P(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class ys extends ta{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ys(e,t,r)}_apply(e){const t=this._parse(e);return kh(e._query,t),new mt(e.firestore,e.converter,zi(e._query,t))}_parse(e){const t=Yo(e.firestore);return function(s,i,o,a,u,c,h){let d;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new P(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){oc(h,c);const l=[];for(const f of h)l.push(ic(a,s,f));d={arrayValue:{values:l}}}else d=ic(a,s,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||oc(h,c),d=ng(o,i,h,c==="in"||c==="not-in");return xe.create(u,c,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mr(n,e,t){const r=e,s=vs("where",n);return ys._create(s,r,t)}class na extends ea{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new na(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:je.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let i=r;const o=s.getFlattenedFilters();for(const a of o)kh(i,a),i=zi(i,a)}(e._query,t),new mt(e.firestore,e.converter,zi(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ra extends ta{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ra(e,t)}_apply(e){const t=function(r,s,i){if(r.startAt!==null)throw new P(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new P(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ht(s,i);return function(a,u){if(ko(a)===null){const c=is(a);c!==null&&Nh(a,c,u.field)}}(r,o),o}(e._query,this._field,this._direction);return new mt(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new sn(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function og(n,e="asc"){const t=e,r=vs("orderBy",n);return ra._create(r,t)}class sa extends ta{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new sa(e,t,r)}_apply(e){return new mt(e.firestore,e.converter,Or(e._query,this._limit,this._limitType))}}function ag(n){return j1("limit",n),sa._create("limit",n,"F")}function ic(n,e,t){if(typeof(t=Ze(t))=="string"){if(t==="")throw new P(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lu(e)&&t.indexOf("/")!==-1)throw new P(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ae.fromString(t));if(!U.isDocumentKey(r))throw new P(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return S0(n,new U(r))}if(t instanceof Pe)return S0(n,t._key);throw new P(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xs(t)}.`)}function oc(n,e){if(!Array.isArray(n)||n.length===0)throw new P(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function kh(n,e){if(e.isInequality()){const r=is(n),s=e.field;if(r!==null&&!r.isEqual(s))throw new P(F.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=ko(n);i!==null&&Nh(n,s,i)}const t=function(r,s){for(const i of r)for(const o of i.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Nh(n,e,t){if(!t.isEqual(e))throw new P(F.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class cg{convertValue(e,t="none"){switch(_t(e)){case 0:return null;case 1:return e.booleanValue;case 2:return de(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Bt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return It(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertGeoPoint(e){return new Qo(de(e.latitude),de(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=bo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(On(e));default:return null}}convertTimestamp(e){const t=lt(e);return new pe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ae.fromString(e);ce(rh(r));const s=new Pn(r.get(1),r.get(3)),i=new U(r.popFirst(5));return s.isEqual(t)||et(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class hg extends Ih{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ar(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(vs("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Ar extends hg{data(e={}){return super.data(e)}}class lg{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new vr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ar(this._firestore,this._userDataWriter,r.key,r,new vr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>{const a=new Ar(r._firestore,r._userDataWriter,o.doc.key,o.doc,new vr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:i++}})}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new Ar(r._firestore,r._userDataWriter,o.doc.key,o.doc,new vr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,c=-1;return o.type!==0&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:fg(o.type),doc:a,oldIndex:u,newIndex:c}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function fg(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}class dg extends cg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,t)}}function yr(n){n=Ft(n,mt);const e=Ft(n.firestore,nr),t=Dh(e),r=new dg(e);return ig(n._query),H1(t,n._query).then(s=>new lg(e,r,n,s))}function xg(n,e,t,...r){n=Ft(n,Pe);const s=Ft(n.firestore,nr),i=Yo(s);let o;return o=typeof(e=Ze(e))=="string"||e instanceof gs?tg(i,"updateDoc",n._key,e,t,r):eg(i,"updateDoc",n._key,e),ia(s,[o.toMutation(n._key,He.exists(!0))])}function wg(n){return ia(Ft(n.firestore,nr),[new No(n._key,He.none())])}function pg(n,e){const t=Ft(n.firestore,nr),r=G1(n),s=ug(n.converter,e);return ia(t,[J1(Yo(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,He.exists(!1))]).then(()=>r)}function ia(n,e){return function(t,r){const s=new ct;return t.asyncQueue.enqueueAndForget(async()=>F1(await $1(t),r,s)),s.promise}(Dh(n),e)}(function(n,e=!0){(function(t){rn=t})(jf),_r(new Bn("firestore",(t,{instanceIdentifier:r,options:s})=>{const i=t.getProvider("app").getImmediate(),o=new nr(new lx(t.getProvider("auth-internal")),new px(t.getProvider("app-check-internal")),function(a,u){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new P(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pn(a.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Ut(D0,"3.13.0",n),Ut(D0,"3.13.0","esm2017")})();var gg="firebase",mg="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ut(gg,mg,"app");const vg={apiKey:"AIzaSyDEwFBY5j9mUTTQcBf_oeMmifreUJa87hM",authDomain:"cxre-423d7.firebaseapp.com",projectId:"cxre-423d7",storageBucket:"cxre-423d7.firebasestorage.app",messagingSenderId:"759302473265",appId:"1:759302473265:web:61fa802b1ec08e584cb710"},yg=vc(vg),Ci=Q1(yg),Ag=Qh("auth",()=>{const n=[],e={},t=u=>{e.data=u},r=(u,c="")=>{console.error(u),n.push(c)},s=async u=>{n.splice(0,n.length);try{const c=Ei(Ci,ws),h=gr(c,mr("email","==",u.email.toLowerCase()),mr("password","==",t0(u.password))),{empty:d,docs:l}=await yr(h);if(d){n.push("Invalid credentials to login");return}const f=l[0].data();f.password="";const x={token:va()};await xg(l[0].ref,x),t({name:f.name,email:f.email.toLowerCase(),id:f.ID})}catch(c){r(c,"Error in sign in")}},i=async u=>{n.splice(0,n.length);try{const c=Ei(Ci,ws),h=gr(c,mr("email","==",u.email.toLowerCase())),{empty:d}=await yr(h);if(!d){n.push("This e-mail already is used");return}const l=await yr(gr(c,og("ID","desc"),ag(1)));let f=0;l.empty||(f=l.docs[0].data().ID);const x=f+1,v={name:u.name,email:u.email.toLowerCase(),password:t0(u.password),token:va(),ID:x};await pg(c,v),t({name:u.name,email:u.email.toLowerCase(),id:x})}catch(c){r(c,"Error in sign in")}},o=async()=>{if(n.splice(0,n.length),!!ya())try{const u=Ei(Ci,ws),c=gr(u,mr("token","==",ya())),{docs:h}=await yr(c);if(h.length==0){a();return}const d=h[0].data();d.password="",t({name:d.name,email:d.email.toLowerCase(),id:d.ID})}catch(u){r(u,"Não foi possível carregar os dados do usuário")}},a=()=>{localStorage.clear(),sessionStorage.clear(),Xh.push({name:Yh})};return{error:n,user:e,signIn:s,signUp:i,fetchUser:o,purgeAuth:a}});export{Cg as I,gr as R,Ei as _,yr as a,mr as b,Ci as d,xg as g,ag as k,pg as p,Ag as u,og as x,wg as y};
